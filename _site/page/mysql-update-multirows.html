<p>MySQL语句使用过程中，会用到一些多行更新的场景。比较常见的是，把多行都更新成同一个值。如：</p>

<div class="language-sql highlighter-rouge"><pre class="highlight"><code><span class="k">UPDATE</span> <span class="k">table_name</span>  
<span class="k">SET</span> <span class="n">column_value</span><span class="o">=</span><span class="mi">1</span>  
<span class="k">WHERE</span> <span class="n">column_id</span> <span class="k">IN</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
</code></pre>
</div>

<p>如果更新多行数据，且值是不同的，往往会使用for循环进行更新。如：</p>

<div class="language-php highlighter-rouge"><pre class="highlight"><code>foreach ($data_list as $item) {  
    $sql = "UPDATE table_name SET column={$item['value']} WHERE column={$item['id']}";  
    $ret = mysql_query($sql);  
    if ($ret === false) {  
        //...
    }  
}  
</code></pre>
</div>

<p>这样写网络交互次数比较多，可能会导致性能问题，看起来也不优雅。
那能否一条SQL搞定呢？答案是肯定的。</p>

<div class="language-sql highlighter-rouge"><pre class="highlight"><code><span class="k">UPDATE</span> <span class="k">table_name</span>  
<span class="k">SET</span> <span class="n">column_value</span> <span class="o">=</span> <span class="k">CASE</span> <span class="n">column_id</span>  
    <span class="k">WHEN</span> <span class="mi">1</span> <span class="k">THEN</span> <span class="mi">0</span>  
    <span class="k">WHEN</span> <span class="mi">2</span> <span class="k">THEN</span> <span class="mi">1</span>  
    <span class="k">WHEN</span> <span class="mi">3</span> <span class="k">THEN</span> <span class="mi">2</span>  
<span class="k">WHERE</span> <span class="n">column_id</span> <span class="k">IN</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
</code></pre>
</div>

<p>同理，也可以使用此方法设置多行多个值。</p>

<div class="language-sql highlighter-rouge"><pre class="highlight"><code><span class="k">UPDATE</span> <span class="k">table_name</span>  
<span class="k">SET</span> <span class="n">column_value</span> <span class="o">=</span> <span class="k">CASE</span> <span class="n">column_id</span>  
    <span class="k">WHEN</span> <span class="mi">1</span> <span class="k">THEN</span> <span class="mi">0</span>  
    <span class="k">WHEN</span> <span class="mi">2</span> <span class="k">THEN</span> <span class="mi">1</span>  
    <span class="k">WHEN</span> <span class="mi">3</span> <span class="k">THEN</span> <span class="mi">2</span><span class="p">,</span>  
<span class="k">SET</span> <span class="n">column_desc</span> <span class="o">=</span> <span class="k">CASE</span> <span class="n">column_id</span>  
    <span class="k">WHEN</span> <span class="mi">1</span> <span class="k">THEN</span> <span class="s1">'test 1'</span>
    <span class="k">WHEN</span> <span class="mi">2</span> <span class="k">THEN</span> <span class="s1">'test 2'</span>
    <span class="k">WHEN</span> <span class="mi">3</span> <span class="k">THEN</span> <span class="s1">'test 3'</span>
<span class="k">WHERE</span> <span class="n">column_id</span> <span class="k">IN</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
</code></pre>
</div>

<p>END.</p>
