<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>David Zhang</title>
    <description>A minimalist programmer, photographer and lifes lover.</description>
    <link>https://crispgm.com/</link>
    <atom:link href="https://crispgm.com/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Sun, 11 Dec 2016 23:53:42 +0800</pubDate>
    <lastBuildDate>Sun, 11 Dec 2016 23:53:42 +0800</lastBuildDate>
    <generator>Jekyll v3.3.0</generator>
    
      <item>
        <title>技术周刊自动化</title>
        <description>&lt;h2 id=&quot;section&quot;&gt;背景&lt;/h2&gt;

&lt;p&gt;技术博客和技术周刊对于一个有技术追求的技术团队来说都是标配，意义在于团队的技术氛围。由于日常业务繁忙和技术深度等原因，大多数技术周刊都是以转载为主。技术周刊的“主编”也就是负责人，肯定需要从事文章收集、筛选、格式化、校验和编译，并不需要编辑什么内容。这部分工作量不大，但枯燥无意义。我也是其中的一员，因此我决定用“技术周刊自动化”来解决技术周刊的整套收集、筛选、校验和发布的流程。&lt;/p&gt;

&lt;p&gt;这是我所在团队的技术博客 &lt;a href=&quot;https://msbu-tech.github.io/&quot;&gt;https://msbu-tech.github.io/&lt;/a&gt;，基于 Jekyll 创建，分为博客、周刊、分享、项目等板块。其中，最活跃的就是&lt;a href=&quot;https://msbu-tech.github.io/weekly/&quot;&gt;技术周刊&lt;/a&gt;。技术周刊每周都会发布，接收所有团队成员投稿，收集编译完毕后会发布到网站上，并且需要再在内部邮件组转一份。&lt;/p&gt;

&lt;h2 id=&quot;section-1&quot;&gt;如何自动化？&lt;/h2&gt;

&lt;p&gt;整体思路是基于 GitHub 构建一套自动化流程，通过 issues 进行收集，然后用脚本调用 GitHub API 处理导入和编译的各项步骤。&lt;/p&gt;

&lt;p&gt;由于是 Jekyll 是 Ruby 编写的，因此选择 Ruby 比较合适。并且由于只是一些简单的任务式脚本，所以选择 &lt;code class=&quot;highlighter-rouge&quot;&gt;Rakefile&lt;/code&gt; 作为载体来编写。&lt;/p&gt;

&lt;h3 id=&quot;section-2&quot;&gt;整体流程&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;在 issues 中开启收集贴&lt;/li&gt;
  &lt;li&gt;从 issues 中导入周刊（处理格式、生成 yaml 和 markdown）&lt;/li&gt;
  &lt;li&gt;人工编译确认和自动化检测&lt;/li&gt;
  &lt;li&gt;发布然后关闭 issue 并感谢投稿人&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;section-3&quot;&gt;准备工作&lt;/h3&gt;

&lt;h4 id=&quot;github-api&quot;&gt;GitHub API&lt;/h4&gt;

&lt;p&gt;选择 Ruby 还有个好处就是 GitHub 自身是用 Ruby 编写，因此 GitHub API 的 Ruby 库 &lt;a href=&quot;https://github.com/octokit/octokit.rb&quot;&gt;Octokit.rb&lt;/a&gt; 非常简单好用。&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;client&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Octokit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Client&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:access_token&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;access_token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;accesstoken&quot;&gt;access_token&lt;/h4&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;access_token&lt;/code&gt; 不能对外暴露，因此需要在环境变量中设置或者通过指定环境变量来运行 &lt;code class=&quot;highlighter-rouge&quot;&gt;rake&lt;/code&gt;。&lt;/p&gt;

&lt;h4 id=&quot;msbu-bot&quot;&gt;msbu-bot&lt;/h4&gt;

&lt;p&gt;作为一个自动化的工作，我引入了一个机器人账号 &lt;a href=&quot;https://github.com/msbu-bot/&quot;&gt;msbu-bot&lt;/a&gt;，在调用 GitHub API 时使用。&lt;/p&gt;

&lt;h3 id=&quot;section-4&quot;&gt;文章收集&lt;/h3&gt;

&lt;p&gt;建立一个专门 Repo 收集周刊内容 &lt;a href=&quot;https://github.com/msbu-tech/weekly&quot;&gt;msbu-tech/weekly&lt;/a&gt;。里面没有代码，只有 &lt;code class=&quot;highlighter-rouge&quot;&gt;README&lt;/code&gt; 来说明投稿的步骤流程，而 issues 则是收集贴。&lt;/p&gt;

&lt;p&gt;开始收集一周的周刊时，先用创建一个收集贴。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ rake open[2016-12-06]
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;也就是调用 &lt;code class=&quot;highlighter-rouge&quot;&gt;Octokit.rb&lt;/code&gt; 发 issue 接口：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;client.create_issue(repo_name, issue_name, &quot;MSBU Weekly #{weekly_date} is now in collecting. Post your entry following the instruction of &amp;lt;https://github.com/msbu-tech/weekly#投稿&amp;gt;.&quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/image/msbu-bot-open-issue.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;section-5&quot;&gt;导入和编译&lt;/h3&gt;

&lt;p&gt;周刊文章收集完毕后，我们开始导入：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ rake weekly[2016-12-06, true]
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;文章投稿的格式是：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/post
- 疯狂的JSONP
- http://www.cnblogs.com/twobin/p/3395086.html
- 何为跨域？何为JSONP？JSONP技术能实现什么？是否有必要使用JSONP技术？
- javascript, jsonp, 跨域
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;这里面的工作主要是是遍历 issue，识别 &lt;code class=&quot;highlighter-rouge&quot;&gt;/post&lt;/code&gt; 投稿标识，然后获取标签、链接、介绍或评语、标签，而回贴人的 ID 就视为推荐人。&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;issue_comment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;title&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;link&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;comment&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;tags&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;referrer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:login&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;each_with_index&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;when&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;strip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;eql?&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/post&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;puts&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;[INFO] Skip comment &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;number&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;green&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;when&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;title&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Spacifier&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;spacify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;strip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;- &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;at&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;when&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;link&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;strip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;- &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;at&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;when&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;comment&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Spacifier&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;spacify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;strip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;- &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;at&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;when&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;tags&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;strip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;- &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;at&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;articles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:title&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:link&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;link&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:comment&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;comment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:tags&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tags&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:referrer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;referrer&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;其中，&lt;code class=&quot;highlighter-rouge&quot;&gt;Spacifier&lt;/code&gt; 是我自己做的一个 &lt;a href=&quot;https://github.com/crispgm/spacifier&quot;&gt;Gem&lt;/a&gt;，用于在中英文共存的字符串中，在中英文之间加一个空格。这样可以优化显示效果，之前为了一些完美主义都是手动转的。&lt;code class=&quot;highlighter-rouge&quot;&gt;Spacifier&lt;/code&gt; 目前功能还不太完善，后续会慢慢改善。&lt;/p&gt;

&lt;p&gt;导入文件后会提示导入文章数，并创建周刊网页和邮件所需的 Markdown 文件。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[INFO] Imported 8 article(s).
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;section-6&quot;&gt;测试&lt;/h3&gt;

&lt;p&gt;导入了文章后，需要进行一些基本的测试。投稿人和主编们时常会写错写重复一些字段，所以做了个自动化测试进行重复检测和字段缺失检测。这也接了 Travis 进行持续集成。&lt;/p&gt;

&lt;p&gt;同时，推荐一个好用的 Gem —— &lt;a href=&quot;https://github.com/fazibear/colorize&quot;&gt;colorize&lt;/a&gt;。&lt;code class=&quot;highlighter-rouge&quot;&gt;colorize&lt;/code&gt; “打开”了 &lt;code class=&quot;highlighter-rouge&quot;&gt;String&lt;/code&gt;，需要报错的时候，只需要在输出的字符串后面调用 &lt;code class=&quot;highlighter-rouge&quot;&gt;.red&lt;/code&gt; 方法，就可以在控制台用红色显示，很醒目。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;puts &quot;[ERROR] Import articles error!&quot;.red
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;section-7&quot;&gt;发布&lt;/h3&gt;

&lt;p&gt;最后一步就是发布了。&lt;/p&gt;

&lt;p&gt;文件都已经生成好，只需要 &lt;code class=&quot;highlighter-rouge&quot;&gt;git push&lt;/code&gt; 到 GitHub，就能生效了。&lt;/p&gt;

&lt;p&gt;我们还需要做的是告诉大家周刊发布的好消息，对投稿人表示感谢，然后关闭掉 issue。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ rake publish
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;comment = &amp;lt;&amp;lt;-EOL
  Congratulations!
  MSBU Weekly #{weekly_date} is published on &amp;lt;https://msbu-tech.github.io/weekly/#{weekly_date}-weekly.html&amp;gt;!
  Thanks #{contributors_list.join ', '} for your great contribution!
  EOL

client.add_comment(repo_name, number, comment)
client.close_issue(repo_name, number)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/image/msbu-bot-say-thanks-and-close.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;section-8&quot;&gt;写在最后&lt;/h2&gt;

&lt;p&gt;文章所说的源码在 &lt;a href=&quot;https://github.com/msbu-tech/msbu-tech.github.io/blob/master/Rakefile&quot;&gt;https://github.com/msbu-tech/msbu-tech.github.io/blob/master/Rakefile&lt;/a&gt;。&lt;/p&gt;

&lt;p&gt;如果本文帮助了你或者给了一些启发，帮忙来个 Star 吧。&lt;/p&gt;
</description>
        <pubDate>Tue, 06 Dec 2016 00:00:00 +0800</pubDate>
        <link>https://crispgm.com/page/engineering-weekly-automation.html</link>
        <guid isPermaLink="true">https://crispgm.com/page/engineering-weekly-automation.html</guid>
        
        <category>Jekyll</category>
        
        <category>rake</category>
        
        <category>周刊</category>
        
        <category>自动化</category>
        
        
      </item>
    
      <item>
        <title>Unsplash, 简单纯粹的图片分享</title>
        <description>&lt;p&gt;最近，微博上关注的开发者推荐了一个由&lt;a href=&quot;http://sspai.com/&quot;&gt;少数派&lt;/a&gt;制作的小而美的壁纸 App - &lt;a href=&quot;http://sspai.com/33525&quot;&gt;Cuto&lt;/a&gt;。这 PR 文里面提到：&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Cuto 每周只会更新 6 ~ 10 张新图片，每一张都会经过精挑细选。因为我们认为，随便选几十张图片抛给用户挑选，不仅是对用户的不负责，也是对自己产品的不负责。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;同时，也将到图片的来源：&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Cuto 里面的图片来自著名的无版权图片网站 Unsplash&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;于是，我出于好奇就找到了 &lt;a href=&quot;https://unsplash.com/&quot;&gt;Unsplash&lt;/a&gt;，以及 Cuto 壁纸的 &lt;a href=&quot;https://unsplash.com/collections/136026/cuto-wallpaper&quot;&gt;Collection&lt;/a&gt;。&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://unsplash.com/&quot;&gt;Unsplash&lt;/a&gt; 是一个免费的高清图片网站。&lt;strong&gt;高品质&lt;/strong&gt;，在 Unsplash 上传照片至少要有300万像素。&lt;strong&gt;简单&lt;/strong&gt;，Unsplash 的设计很简洁，精力会被集中在图片本身。&lt;strong&gt;纯粹&lt;/strong&gt;，没有过度的社交，没有任何 annoying 提醒。除了查看、下载和收藏外，也就只有点赞了。点赞并不是为了社交，而是对作者表示感谢。最后，令人惊喜和值得期待的是，Unsplash 上面的图片可以免费下载和使用。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;All photos published on Unsplash are licensed under Creative Commons Zero which means you can copy, modify, distribute and use the photos for free, including commercial purposes, without asking permission from or providing attribution to the photographer or Unsplash.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;我从来不轻易相信免费的东西，但 Unsplash 真正做到了免费的高品质。毫无犹豫，我在 &lt;a href=&quot;https://crispgm.com/&quot;&gt;crispgm.com&lt;/a&gt; 的404页面中，嵌入了 Unsplash 随机推荐图。点这里看看吧： &lt;a href=&quot;https://crispgm.com/404.html&quot;&gt;https://crispgm.com/404.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;同时，也推荐一下 &lt;a href=&quot;https://chrome.google.com/webstore/detail/unsplash-instant/pejkokffkapolfffcgbmdmhdelanoaih?hl=en&quot;&gt;Unsplash Instant&lt;/a&gt;。Unsplash 官方出品的 Chrome 扩展，每次打开一个 Tab，都会显示一张图片。&lt;/p&gt;

&lt;p&gt;感谢 &lt;a href=&quot;https://crew.co/&quot;&gt;Crew&lt;/a&gt; 让我们拥有这么美好的体验！Crew 也是一个很美的公司，有兴趣的可以自行看看它们的招聘页面和团队博客，体会一下别人家的公司是什么样。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://crew.co/hiring/assets/img/photo-6.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://crew.co/hiring/assets/img/photo-4.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
</description>
        <pubDate>Wed, 30 Nov 2016 00:00:00 +0800</pubDate>
        <link>https://crispgm.com/page/unsplash-simple-pure-photos.html</link>
        <guid isPermaLink="true">https://crispgm.com/page/unsplash-simple-pure-photos.html</guid>
        
        <category>unsplash</category>
        
        
      </item>
    
      <item>
        <title>48 个你需要知道的 Jekyll 使用技巧</title>
        <description>&lt;p&gt;很久以前，本人的个人博客是 PHP 写的简单页面，实时转换 Markdown。后来，为了简单，用 PHP 写了一个静态博客转换器。虽用起来还比较舒服，但通用性太差了。于是转向 GitHub Pages 官方支持的 Jekyll，没想到只花了20分钟就完成了迁移，开发体验颇好。深入使用和参与了许久后，决定写一篇 Jekyll 相关的 Tips 的文章，仅供大家参考。&lt;/p&gt;

&lt;h2 id=&quot;section&quot;&gt;简介&lt;/h2&gt;

&lt;h4 id=&quot;jekyll&quot;&gt;什么是 Jekyll&lt;/h4&gt;

&lt;p&gt;&lt;a href=&quot;https://jekyllrb.com/&quot;&gt;Jekyll&lt;/a&gt; 是一个简单的，博客感知的，静态网站生成器。&lt;/p&gt;

&lt;h4 id=&quot;section-1&quot;&gt;安装&lt;/h4&gt;

&lt;p&gt;首先，你得有 Ruby。对于 Mac 用户，可以使用 Homebrew 安装。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;brew install ruby
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;然后：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ gem install jekyll
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;gem-&quot;&gt;Gem 安装不上或者很慢怎么办？&lt;/h4&gt;

&lt;p&gt;RubyGems 是一个优秀的包管理系统，但再优秀也扛不住墙和距离，所以一般情况下，中国大陆的用户需要更换 RubyGems 的源。&lt;/p&gt;

&lt;p&gt;建议更换成 Ruby-China 的源，参考 &lt;a href=&quot;https://gems.ruby-china.org/&quot;&gt;https://gems.ruby-china.org/&lt;/a&gt;。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ gem sources --add https://gems.ruby-china.org/ --remove https://rubygems.org/
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;同时，也广告一下本人的作品：&lt;a href=&quot;https://crispgm.github.io/gsm/&quot;&gt;Gem Sources Manager&lt;/a&gt;，专门用于切换源。&lt;/p&gt;

&lt;h4 id=&quot;mac-osx-el-capitan-&quot;&gt;Mac OSX El Capitan 安装失败&lt;/h4&gt;

&lt;p&gt;从 Mac OSX El Capitan 开始，Apple 采取了一个叫 SIP 的东西保护系统文件夹，导致 &lt;code class=&quot;highlighter-rouge&quot;&gt;/usr/bin&lt;/code&gt; 等文件夹无法写入。因此需要更换安装路径。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo gem install -n /usr/local/bin jekyll
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;详见 &lt;a href=&quot;https://jekyllrb.com/docs/troubleshooting/#jekyll-amp-mac-os-x-1011&quot;&gt;https://jekyllrb.com/docs/troubleshooting/#jekyll-amp-mac-os-x-1011&lt;/a&gt;&lt;/p&gt;

&lt;h4 id=&quot;bundler&quot;&gt;Bundler&lt;/h4&gt;

&lt;p&gt;Jekyll 3.3.0 之后开始采用 Bundler 方式运行。安装时，需要同时安装 Bundler：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ gem install jekyll bundler
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;所以所有命令可能也需要使用 Bundler：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ bundle exec jekyll serve
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h2 id=&quot;section-2&quot;&gt;命令&lt;/h2&gt;

&lt;h4 id=&quot;jekyll-new-&quot;&gt;使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;jekyll new&lt;/code&gt; 创建新站点&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ jekyll new my-jekyll-site
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;也可以：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ mkdir my-jekyll-site
$ cd my-jekyll-site
$ jekyll new .
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;jekyll-serve-&quot;&gt;使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;jekyll serve&lt;/code&gt; 在本地运行站点&lt;/h4&gt;

&lt;p&gt;以下三种使用方式是等价的：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ jekyll serve
$ jekyll server
$ jekyll s
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;http://localhost:4000&lt;/code&gt; 进行访问。&lt;/p&gt;

&lt;h4 id=&quot;jekyll-build-&quot;&gt;使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;jekyll build&lt;/code&gt; 生成站点&lt;/h4&gt;

&lt;p&gt;以下两种使用方式是等价的：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ jekyll build
$ jekyll b
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;--destination&lt;/code&gt; 指定目标路径：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ jekyll build --destination=/path/to/site
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;jekyll-new-theme-&quot;&gt;使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;jekyll new-theme&lt;/code&gt; 创建主题&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ jekyll new-theme my-theme
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h2 id=&quot;section-3&quot;&gt;基础&lt;/h2&gt;

&lt;h4 id=&quot;section-4&quot;&gt;目录结构&lt;/h4&gt;

&lt;p&gt;一个基本的 Jekyll 站点目录结构：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;.
├── _config.yml
├── _data
|   └── members.yml
├── _drafts
|   ├── begin-with-the-crazy-ideas.md
|   └── on-simplicity-in-technology.md
├── _includes
|   ├── footer.html
|   └── header.html
├── _layouts
|   ├── default.html
|   └── post.html
├── _posts
|   ├── 2007-10-29-why-every-programmer-should-play-nethack.md
|   └── 2009-04-26-barcamp-boston-4-roundup.md
├── _sass
|   ├── _base.scss
|   └── _layout.scss
├── _site
├── .jekyll-metadata
└── index.html # 也可以是 index.md
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;_config.yml
    &lt;ul&gt;
      &lt;li&gt;Jekyll 站点的总配置文件，有很多选项也可以通过命令行方式指定。&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;_drafts
    &lt;ul&gt;
      &lt;li&gt;未发布的草稿，文件名不需要带有日期。&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;_includes
    &lt;ul&gt;
      &lt;li&gt;代码片段，可以通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;include&lt;/code&gt; 进行引用。&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;_layouts
    &lt;ul&gt;
      &lt;li&gt;布局。布局文件可以被继承，&lt;code class=&quot;highlighter-rouge&quot;&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;}&lt;/span&gt;&lt;/code&gt; 用于表示被继承者的内容。&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;_posts
    &lt;ul&gt;
      &lt;li&gt;文件，命名需要以日期开头：如 &lt;code class=&quot;highlighter-rouge&quot;&gt;2016-12-01-my-article.md&lt;/code&gt;。&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;_sass
    &lt;ul&gt;
      &lt;li&gt;sass 文件，可以通过插件完成编译。也可以选择引入原生 CSS，或者 Less 等。&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;_site
    &lt;ul&gt;
      &lt;li&gt;目标文件，建议加入到 &lt;code class=&quot;highlighter-rouge&quot;&gt;.gitignore&lt;/code&gt; 中。&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;index.html/index.md
    &lt;ul&gt;
      &lt;li&gt;首页&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;configyml&quot;&gt;_config.yml&lt;/h4&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;_config.yml&lt;/code&gt; 是整个站点的整体配置，以下是所有配置项和默认值：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# Where things are
source:       .
destination:  ./_site
plugins_dir:  _plugins
layouts_dir:  _layouts
data_dir:     _data
includes_dir: _includes
collections:
  posts:
    output:   true

# Handling Reading
safe:         false
include:      [&quot;.htaccess&quot;]
exclude:      [&quot;node_modules&quot;, &quot;vendor/bundle/&quot;, &quot;vendor/cache/&quot;, &quot;vendor/gems/&quot;, &quot;vendor/ruby/&quot;]
keep_files:   [&quot;.git&quot;, &quot;.svn&quot;]
encoding:     &quot;utf-8&quot;
markdown_ext: &quot;markdown,mkdown,mkdn,mkd,md&quot;

# Filtering Content
show_drafts: null
limit_posts: 0
future:      false
unpublished: false

# Plugins
whitelist: []
gems:      []

# Conversion
markdown:    kramdown
highlighter: rouge
lsi:         false
excerpt_separator: &quot;\n\n&quot;
incremental: false

# Serving
detach:  false
port:    4000
host:    127.0.0.1
baseurl: &quot;&quot; # does not include hostname
show_dir_listing: false

# Outputting
permalink:     date
paginate_path: /page:num
timezone:      null

quiet:    false
verbose:  false
defaults: []

liquid:
  error_mode: warn

# Markdown Processors
rdiscount:
  extensions: []

redcarpet:
  extensions: []

kramdown:
  auto_ids:       true
  footnote_nr:    1
  entity_output:  as_char
  toc_levels:     1..6
  smart_quotes:   lsquo,rsquo,ldquo,rdquo
  input:          GFM
  hard_wrap:      false
  footnote_nr:    1
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;front-matter&quot;&gt;Front Matter&lt;/h4&gt;

&lt;p&gt;Jekyll 整个站点的配置是站点根目录下的 &lt;code class=&quot;highlighter-rouge&quot;&gt;_config.yml&lt;/code&gt; 文件，而 &lt;code class=&quot;highlighter-rouge&quot;&gt;_layout&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;_posts&lt;/code&gt; 等目录下的文件中也可以有自己的变量。文件头部的 &lt;code class=&quot;highlighter-rouge&quot;&gt;yaml&lt;/code&gt; 配置被称作 Front Matter。&lt;/p&gt;

&lt;h4 id=&quot;front-matter-&quot;&gt;Front Matter 默认值&lt;/h4&gt;

&lt;p&gt;可以使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;defaults&lt;/code&gt; 设置一个路径下 Front Matter 默认值。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;defaults:
  - scope:
      path: &quot;&quot;
      type: weekly
    values:
      layout: weekly
      title: 技术周刊
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;section-5&quot;&gt;忽略文件&lt;/h4&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;exclude&lt;/code&gt; 用于忽略文件或文件夹，其中 &lt;code class=&quot;highlighter-rouge&quot;&gt;_config.yml&lt;/code&gt; 和以&lt;code class=&quot;highlighter-rouge&quot;&gt;.&lt;/code&gt;开头的文件或文件夹都会被自动忽略。后续版本，&lt;code class=&quot;highlighter-rouge&quot;&gt;node_modules&lt;/code&gt; 等文件夹也被隐式忽略了（参考 _config.yml 章节）。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;exclude:
  - Gemfile
  - Gemfile.lock
  - README.md
  - LICENSE
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;section-6&quot;&gt;分页&lt;/h4&gt;

&lt;p&gt;Jekyll 没有内置分页功能，而是提供了一个分页插件 &lt;code class=&quot;highlighter-rouge&quot;&gt;jekyll-paginate&lt;/code&gt;。&lt;code class=&quot;highlighter-rouge&quot;&gt;jekyll-paginate&lt;/code&gt; 仅在特定的默认条件下生效，如果你对网站结构有自己的一套，&lt;code class=&quot;highlighter-rouge&quot;&gt;jekyll-paginate&lt;/code&gt; 可能是无法满足需求的。&lt;/p&gt;

&lt;p&gt;限制如下：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;分页功能必须在 HTML 格式文件中调用，如：&lt;code class=&quot;highlighter-rouge&quot;&gt;index.html&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;必须使用默认的链接格式 &lt;code class=&quot;highlighter-rouge&quot;&gt;permalink&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;如果想继续使用，请详细阅读 &lt;a href=&quot;http://jekyllrb.com/docs/pagination/&quot;&gt;http://jekyllrb.com/docs/pagination/&lt;/a&gt;。这是一个复杂的问题！&lt;/p&gt;

&lt;h4 id=&quot;section-7&quot;&gt;文章摘要&lt;/h4&gt;

&lt;p&gt;Jekyll 提供了文章摘要摘取功能，通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;post.excerpt&lt;/code&gt; 就可以获得摘要内容。&lt;/p&gt;

&lt;p&gt;我们也可以设置摘取摘要的分隔符：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;excerpt_separator: &amp;lt;!--more--&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;section-8&quot;&gt;评论&lt;/h4&gt;

&lt;p&gt;由于是静态站点，我们没发内建评论系统，因此需要引入一些纯前端就可以使用的评论系统。国外推荐：&lt;a href=&quot;https://disqus.com/&quot;&gt;disqus&lt;/a&gt;，国内推荐：&lt;a href=&quot;http://duoshuo.com/&quot;&gt;duoshuo&lt;/a&gt;。&lt;/p&gt;

&lt;h4 id=&quot;page&quot;&gt;Page&lt;/h4&gt;

&lt;p&gt;可以认为，不在 &lt;code class=&quot;highlighter-rouge&quot;&gt;_post&lt;/code&gt; 目录下的页面都是 Page 而不是 Post，其它方面区别不大。&lt;/p&gt;

&lt;h4 id=&quot;collection&quot;&gt;Collection&lt;/h4&gt;

&lt;p&gt;并不是每个页面都是独立“页面”和以日期为顺序的“博文”，因此 Jekyll 引入了 Collection。Collection 可以根据路径定义一类具有相同属性的页面集合。Collection 也可以通过 Front Matter 设定默认值。&lt;/p&gt;

&lt;h4 id=&quot;data&quot;&gt;Data&lt;/h4&gt;

&lt;p&gt;Data 相当于动态页面中的数据库，Jekyll Data 支持 &lt;code class=&quot;highlighter-rouge&quot;&gt;yaml&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;json&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;CSV&lt;/code&gt; 三种格式，可以通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;site.data&lt;/code&gt; 直接访问。&lt;/p&gt;

&lt;p&gt;例如：&lt;/p&gt;

&lt;p&gt;团队成员有 Fa, Li, Zhang 三人，于是我们在默认路径 &lt;code class=&quot;highlighter-rouge&quot;&gt;_data&lt;/code&gt; 创建一个数据文件 &lt;code class=&quot;highlighter-rouge&quot;&gt;member.yml&lt;/code&gt;：&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Fa&lt;/span&gt;
&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Li&lt;/span&gt;
&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Zhang&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;在页面中显示团队成员列表：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;member&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;in&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;site.data.member&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;lt;ul&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;lt;li&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;member.name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;}&amp;lt;/li&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;lt;/ul&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;endfor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h2 id=&quot;liquid-&quot;&gt;Liquid 模板&lt;/h2&gt;

&lt;h4 id=&quot;liquid&quot;&gt;什么是 Liquid?&lt;/h4&gt;

&lt;p&gt;Liquid 是一个开源模版语言，由电商公司 Shopify 实现，用 Ruby 编写。Shopify 自己使用 Liquid 来构建自己电商网站模板生态。&lt;/p&gt;

&lt;p&gt;详细文档请参考 &lt;a href=&quot;https://shopify.github.io/liquid/&quot;&gt;https://shopify.github.io/liquid/&lt;/a&gt;。&lt;/p&gt;

&lt;p&gt;Jekyll 实用 Liquid 作为模版引擎，构建页面。&lt;/p&gt;

&lt;h4 id=&quot;section-9&quot;&gt;变量&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;title&amp;gt;
{{ page.title }}
&amp;lt;/title&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;其中，Jekyll 预设了 &lt;code class=&quot;highlighter-rouge&quot;&gt;site&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;layout&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;page&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;content&lt;/code&gt; 四个全局变量。&lt;/p&gt;

&lt;h4 id=&quot;section-10&quot;&gt;逻辑判断&lt;/h4&gt;

&lt;p&gt;Liquid 的逻辑判断跟 Ruby 完全一致。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;常见语言中的 &lt;code class=&quot;highlighter-rouge&quot;&gt;if/else if/else&lt;/code&gt; 在 Liquid 中的对应是 &lt;code class=&quot;highlighter-rouge&quot;&gt;if/elsif/else&lt;/code&gt;。同时，Liquid 也可以使用 Ruby 特有的 &lt;code class=&quot;highlighter-rouge&quot;&gt;unless&lt;/code&gt;。&lt;/li&gt;
  &lt;li&gt;常见语言中的 &lt;code class=&quot;highlighter-rouge&quot;&gt;switch/case&lt;/code&gt; 在 Liquid 中的对应是 &lt;code class=&quot;highlighter-rouge&quot;&gt;case/when&lt;/code&gt;。&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;为了简单，只以 &lt;code class=&quot;highlighter-rouge&quot;&gt;if&lt;/code&gt; 为例：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;page.disable_syntax_highlight&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;!=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;lt;link&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;rel=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;stylesheet&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;{{ site.assets }}/css/zenburn.css&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;endif&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;section-11&quot;&gt;遍历&lt;/h4&gt;

&lt;p&gt;在 Liquid 中可以通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;for&lt;/code&gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;in&lt;/code&gt; 语法遍历数组，并且支持一般语言循环中的 &lt;code class=&quot;highlighter-rouge&quot;&gt;continue&lt;/code&gt; 和 &lt;code class=&quot;highlighter-rouge&quot;&gt;break&lt;/code&gt;。&lt;/p&gt;

&lt;p&gt;除此之外，还可以使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;offset&lt;/code&gt; 和 &lt;code class=&quot;highlighter-rouge&quot;&gt;limit&lt;/code&gt; 控制遍历范围，通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;reversed&lt;/code&gt; 进行倒序。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;in&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;site.posts&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;reversed&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;lt;a&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;{{ post.permalink }}&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;post.title&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;}&amp;lt;/a&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;endfor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;详见 &lt;a href=&quot;https://shopify.github.io/liquid/tags/iteration/&quot;&gt;https://shopify.github.io/liquid/tags/iteration/&lt;/a&gt;&lt;/p&gt;

&lt;h4 id=&quot;section-12&quot;&gt;赋值&lt;/h4&gt;

&lt;p&gt;使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;assign&lt;/code&gt; 进行赋值：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;assign&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;my_variable&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;capture&lt;/code&gt; 进行捕捉赋值：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;capture&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;my_variable&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;am&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;being&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;captured.&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;endcapture&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;liquid-filters&quot;&gt;Liquid Filters&lt;/h4&gt;

&lt;p&gt;Liquid Filters 是一种针对 Liquid 中变量的过滤器，语法是：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;filter:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;param&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;}}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;除去 Liquid 自身丰富的过滤器之外，Jekyll 还额外扩展了一些实用的：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;cgi_escape/url_escape/xml_escape
    &lt;ul&gt;
      &lt;li&gt;对变量进行相应的 escape&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;markdownify/scssify/sassify/jsonify
    &lt;ul&gt;
      &lt;li&gt;对变量内容的格式转换&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;where/where_exp/group_by/sort
    &lt;ul&gt;
      &lt;li&gt;对变量数据的查询排序等操作&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;详见 &lt;a href=&quot;http://jekyllrb.com/docs/templates/#filters&quot;&gt;http://jekyllrb.com/docs/templates/#filters&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;section-13&quot;&gt;插件&lt;/h2&gt;

&lt;h4 id=&quot;section-14&quot;&gt;插件简介&lt;/h4&gt;

&lt;p&gt;Jekyll 支持使用插件进行扩展，插件的类型分为：Generators、Converters、Commands、Hooks、Liquid Tag、Liquid Filter 等。&lt;/p&gt;

&lt;p&gt;如果希望开发插件，请参考 &lt;a href=&quot;http://jekyllrb.com/docs/plugins/&quot;&gt;http://jekyllrb.com/docs/plugins/&lt;/a&gt;&lt;/p&gt;

&lt;h4 id=&quot;section-15&quot;&gt;使用插件&lt;/h4&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;基于 Gem 的方式&lt;/p&gt;

    &lt;p&gt;对于已经发布到 RubyGems 的插件，推荐使用这种方式。只需要在 &lt;code class=&quot;highlighter-rouge&quot;&gt;_config.yml&lt;/code&gt; 中 &lt;code class=&quot;highlighter-rouge&quot;&gt;gems&lt;/code&gt; 字段加入相应插件名称即可。&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;基于本地文件&lt;/p&gt;

    &lt;p&gt;对于没有发布的插件，可以在 &lt;code class=&quot;highlighter-rouge&quot;&gt;_plugins&lt;/code&gt; 文件夹中直接引入 &lt;code class=&quot;highlighter-rouge&quot;&gt;*.rb&lt;/code&gt; Ruby 源文件。&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;section-16&quot;&gt;常用插件&lt;/h2&gt;

&lt;h4 id=&quot;jekyll-watch&quot;&gt;Jekyll Watch&lt;/h4&gt;

&lt;p&gt;Jekyll “必备”的插件，因为这是 Jekyll 程序的依赖，只是因为程序结构设计被剥离成了插件。它在本地预览时，提供文件变更的自动更新，让我们每次刷新都能自动看到最新的内容。&lt;/p&gt;

&lt;p&gt;Jekyll Watch 是自动开启的：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ jekyll serve --watch
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;jekyll-compose&quot;&gt;Jekyll Compose&lt;/h4&gt;

&lt;p&gt;安装了 &lt;a href=&quot;https://github.com/jekyll/jekyll-compose&quot;&gt;Jekyll Compose&lt;/a&gt; 后，Jekyll 会额外提供一些命令，便于发布管理博文。&lt;/p&gt;

&lt;p&gt;创建草稿：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ jekyll draft
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;创建新博客：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ jekyll post
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;创建新博客：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ jekyll page
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;发布草稿：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ jekyll publish
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;撤销发布：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ jekyll unpublish
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;jekyll-admin&quot;&gt;Jekyll Admin&lt;/h4&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/jekyll/jekyll-admin&quot;&gt;Jekyll Admin&lt;/a&gt; 是一个 CMS 风格的图形化后台管理插件，可以在本地给用户提供服务。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://github.com/jekyll/jekyll-admin/raw/master/screenshot.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;jekyll-seo-tag&quot;&gt;Jekyll SEO Tag&lt;/h4&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/jekyll/jekyll-seo-tag&quot;&gt;Jekyll SEO Tag&lt;/a&gt; 帮你生成一大堆 Meta 标签。&lt;/p&gt;

&lt;h4 id=&quot;jemoji&quot;&gt;Jemoji&lt;/h4&gt;

&lt;p&gt;你可以通过 &lt;a href=&quot;https://github.com/jekyll/jemoji&quot;&gt;Jemoji&lt;/a&gt; 在 Jekyll 生成的网站中，加入自己 Emoji 表情。&lt;/p&gt;

&lt;p&gt;Emoji 语法采用 GitHub 的语法风格。&lt;/p&gt;

&lt;h4 id=&quot;jekyll-mentions&quot;&gt;Jekyll Mentions&lt;/h4&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/jekyll/jekyll-mentions&quot;&gt;Jekyll Mentions&lt;/a&gt; 允许你在文章中直接“@” GitHub 或其它网站用户。&lt;/p&gt;

&lt;h4 id=&quot;jekyll-feed&quot;&gt;Jekyll Feed&lt;/h4&gt;

&lt;p&gt;你可以通过 &lt;a href=&quot;https://github.com/jekyll/jekyll-feed&quot;&gt;Jekyll Feed&lt;/a&gt; 在 Jekyll 生成的网站中，生成 RSS 源。&lt;/p&gt;

&lt;h4 id=&quot;jekyll-import&quot;&gt;Jekyll Import&lt;/h4&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/jekyll/jekyll-import&quot;&gt;Jekyll Import&lt;/a&gt; 支持从一些国外的主流站点导入博文，如 Blogger, WordPress 和 Tumblr 等，同样也支持 RSS 和 CSV 等数据格式导入。&lt;/p&gt;

&lt;h4 id=&quot;jekyll-archives&quot;&gt;Jekyll Archives&lt;/h4&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/jekyll/jekyll-archives&quot;&gt;Jekyll Archives&lt;/a&gt; 用于生成带标签和分类的『存档』页面。&lt;/p&gt;

&lt;h4 id=&quot;jekyll-redirect-from&quot;&gt;Jekyll Redirect From&lt;/h4&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/jekyll/jekyll-redirect-from&quot;&gt;Jekyll Redirect From&lt;/a&gt; 提供页面跳转功能，比较简单，也可以自行通过 JavaScript 实现。&lt;/p&gt;

&lt;h2 id=&quot;github-pages&quot;&gt;GitHub Pages&lt;/h2&gt;

&lt;h4 id=&quot;section-17&quot;&gt;创建个人主页&lt;/h4&gt;

&lt;p&gt;创建一个名为 &lt;code class=&quot;highlighter-rouge&quot;&gt;your-github-username.github.io&lt;/code&gt; 的 Repo，&lt;code class=&quot;highlighter-rouge&quot;&gt;your-github-username&lt;/code&gt; 是你的用户名。&lt;/p&gt;

&lt;p&gt;只需在 Repo 中设置 GitHub Pages 的 Source，就可以开启 GitHub Pages，支持 &lt;code class=&quot;highlighter-rouge&quot;&gt;master&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;gh-pages&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;master&lt;/code&gt; 中 &lt;code class=&quot;highlighter-rouge&quot;&gt;/docs&lt;/code&gt; 文件夹三种 Source。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/image/github-pages-source.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;github-pages-&quot;&gt;在 GitHub Pages 只可以使用部分插件&lt;/h4&gt;

&lt;p&gt;由于安全性等原因的考虑，在 GitHub Pages 平台上只能使用白名单中的 7 个 Jekyll 插件。它们分别是：Jekyll Sitemap, Jekyll SEO Tag, github-metadata, Jekyll Feed, Jekyll Redirect From, Jemoji 和 Jekyll Mentions。&lt;/p&gt;

&lt;p&gt;详见 &lt;a href=&quot;https://help.github.com/articles/adding-jekyll-plugins-to-a-github-pages-site/&quot;&gt;https://help.github.com/articles/adding-jekyll-plugins-to-a-github-pages-site/&lt;/a&gt;。&lt;/p&gt;

&lt;h4 id=&quot;github-pages--jekyll--kramdown&quot;&gt;GitHub Pages 上的 Jekyll 只支持 kramdown&lt;/h4&gt;

&lt;p&gt;从 2016 年 5 月 1 日起，GitHub Pages 只支持 kramdown 作为 Markdown 引擎。&lt;/p&gt;

&lt;p&gt;详见 &lt;a href=&quot;https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0&quot;&gt;https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0&lt;/a&gt;。&lt;/p&gt;

&lt;h4 id=&quot;nojekyll--jekyll-&quot;&gt;在根目录下创建 &lt;code class=&quot;highlighter-rouge&quot;&gt;.nojekyll&lt;/code&gt; 文件可以跳过 Jekyll 解析&lt;/h4&gt;

&lt;p&gt;GitHub Pages 支持 Jekyll 或者原始文件。最初 GitHub Pages 只支持 Jekyll，后来 GitHub 允许在 Repo 根目录下添加 &lt;code class=&quot;highlighter-rouge&quot;&gt;.nojekyll&lt;/code&gt; 跳过解析。详见 &lt;a href=&quot;https://github.com/blog/572-bypassing-jekyll-on-github-pages&quot;&gt;https://github.com/blog/572-bypassing-jekyll-on-github-pages&lt;/a&gt;。&lt;/p&gt;

&lt;h4 id=&quot;section-18&quot;&gt;你可以使用自己的域名&lt;/h4&gt;

&lt;p&gt;在 Source 的根路径下，创建 &lt;code class=&quot;highlighter-rouge&quot;&gt;CNAME&lt;/code&gt; 写入域名，然后把 DNS 解析到 GitHub Pages 的 IP：&lt;code class=&quot;highlighter-rouge&quot;&gt;192.30.252.153&lt;/code&gt;和&lt;code class=&quot;highlighter-rouge&quot;&gt;192.30.252.154&lt;/code&gt;。&lt;/p&gt;

&lt;p&gt;详见 &lt;a href=&quot;https://help.github.com/articles/using-a-custom-domain-with-github-pages/&quot;&gt;https://help.github.com/articles/using-a-custom-domain-with-github-pages/&lt;/a&gt;&lt;/p&gt;

&lt;h4 id=&quot;section-19&quot;&gt;你也可以为账号下任意项目创建独立的项目页面&lt;/h4&gt;

&lt;p&gt;任何一个项目的 Repo，都可以开启这个项目的 GitHub Pages。开启方式同个人主页。&lt;/p&gt;

&lt;p&gt;如项目：&lt;a href=&quot;https://github.com/crispgm/gsm&quot;&gt;crispgm/gsm&lt;/a&gt;，设置完成后，就可以通过 &lt;a href=&quot;https://crispgm.github.io/gsm/&quot;&gt;https://crispgm.github.io/gsm/&lt;/a&gt; 进行访问。&lt;/p&gt;

&lt;h4 id=&quot;sitegithub--repo-&quot;&gt;你可以通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;site.github&lt;/code&gt; 获得 Repo 的信息&lt;/h4&gt;

&lt;p&gt;由上面所说的 &lt;a href=&quot;https://github.com/jekyll/github-metadata&quot;&gt;github-metadata&lt;/a&gt; 提供服务，通过 GitHub API 获取 Repo 的信息。当然，在本地环境下，也可以通过手动安装 github-metadata 来使用。&lt;/p&gt;

&lt;h4 id=&quot;repo--github-pages&quot;&gt;私有 Repo 也可以开启 GitHub Pages&lt;/h4&gt;

&lt;p&gt;GitHub 的付费用户建立的私有项目 Private Repo，也可以开启 GitHub Pages。&lt;/p&gt;

&lt;h4 id=&quot;github-pages--gh-pages-&quot;&gt;GitHub Pages 无法在使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;gh-pages&lt;/code&gt; 分支作为源的情况下关闭&lt;/h4&gt;

&lt;p&gt;有些奇怪的设定，真想关闭直接删除掉，在 Source 选择 None 就好。&lt;/p&gt;

&lt;h2 id=&quot;section-20&quot;&gt;最后&lt;/h2&gt;

&lt;h4 id=&quot;jekyll-&quot;&gt;本博客也是用 Jekyll 生成的&lt;/h4&gt;

&lt;p&gt;Happy Jekylling!&lt;/p&gt;
</description>
        <pubDate>Sat, 19 Nov 2016 00:00:00 +0800</pubDate>
        <link>https://crispgm.com/page/48-tips-for-jekyll-you-should-know.html</link>
        <guid isPermaLink="true">https://crispgm.com/page/48-tips-for-jekyll-you-should-know.html</guid>
        
        <category>jekyll</category>
        
        <category>tips</category>
        
        
      </item>
    
      <item>
        <title>我是如何把自己的 VPS 容器化的</title>
        <description>&lt;p&gt;Docker 是后端近期最火的技术，但在公司生产环境中并没机会使用。由于我的 VPS 主机有容器化的需求，借此机会部署并稍微体验了一下 Docker，谈谈事情的经过和自己的感受。&lt;/p&gt;

&lt;h2 id=&quot;section&quot;&gt;背景&lt;/h2&gt;

&lt;p&gt;一直以来，我使用 Linode VPS 作为个人主机，上面部署着网站。后来，随着国内网络环境的持续恶化，不得不搭建了 VPN 和 Shadowsocks。又由于个人网站样式和博客内容更新的频繁，将网站做成了通过 GitHub Webhook 自动化部署更新。&lt;/p&gt;

&lt;p&gt;目前，VPS 上面搭了若干个服务：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;个人网站（Jekyll 生成静态页面，Certbot 生成 HTTPS 证书&lt;sup id=&quot;fnref:1&quot;&gt;&lt;a href=&quot;#fn:1&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;，nginx 提供服务）&lt;/li&gt;
  &lt;li&gt;基于 PPTP 的 VPN（由于 iOS 10 移除了 PPTP 的支持&lt;sup id=&quot;fnref:2&quot;&gt;&lt;a href=&quot;#fn:2&quot; class=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;，故改为 L2TP）&lt;/li&gt;
  &lt;li&gt;Shadowsocks Server&lt;/li&gt;
  &lt;li&gt;网站同步更新程序&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;但是，在运维和安全角度都一直存在着问题。&lt;/p&gt;

&lt;p&gt;首先，VPS 的搭建是非自动化的，只能手动搭建，十分的麻烦。今年 7 月，VPS 曾经被黑客攻击，导致整个系统需要重做。手动搭建一次，需要几十分钟。尤其是 VPN 的搭建步骤十分多且复杂，造成失误出错的可能性也较高。&lt;/p&gt;

&lt;p&gt;其次，由于历史原因上面的很多程序都是 root 账户运行，有较大的安全风险。之前就曾经发现网站部署程序存在 Shell 注入问题，幸好及时发现修复了。&lt;/p&gt;

&lt;p&gt;最后，就是不同的程序有时会出现互相干扰的情况。如：VPN 使用的 iptables 可能会影响 Nginx 的对外端口。安装和测试新程序时，也会在系统中产生很多垃圾。&lt;/p&gt;

&lt;p&gt;因此，我的需求是：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;相对快捷的自动化构建方式，可快速搭建和恢复&lt;/li&gt;
  &lt;li&gt;不同程序在受限的“沙盒”中运行，并做到资源隔离&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;why-docker&quot;&gt;Why Docker&lt;/h2&gt;

&lt;p&gt;Docker 主要作用是容器化，它可以将一些服务“打包”成一个镜像（Image），然后在 Container 中运行。对于 Container 的描述是这样的：&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Container 技术是直接将一个应用程序所需的相关程序代码、函式库、环境配置文件都打包起来建立沙盒执行环境&lt;sup id=&quot;fnref:4&quot;&gt;&lt;a href=&quot;#fn:4&quot; class=&quot;footnote&quot;&gt;3&lt;/a&gt;&lt;/sup&gt;。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;这样，从需求上讲，我需要自动化的运维能力和沙盒运行等需求都得到了完美的满足。&lt;/p&gt;

&lt;p&gt;从技术趋势上讲，Docker 是目前容器界、云计算界甚至是业界最火的一项技术，也希望以此机会尝尝鲜。&lt;/p&gt;

&lt;p&gt;由于现在的 Linode 东京机房机器非常稳定，且和北京的 ping 非常低。所以，我不会轻易放弃这个 Linode，希望能在 Linode 上搭建 Docker。还好，Linode 早在 2014 年就已经支持了 Docker&lt;sup id=&quot;fnref:3&quot;&gt;&lt;a href=&quot;#fn:3&quot; class=&quot;footnote&quot;&gt;4&lt;/a&gt;&lt;/sup&gt;。&lt;/p&gt;

&lt;h2 id=&quot;docker&quot;&gt;安装 Docker&lt;/h2&gt;

&lt;p&gt;我的 Linux 镜像是 Ubuntu 14.04 LTS，安装方法非常简单&lt;sup id=&quot;fnref:5&quot;&gt;&lt;a href=&quot;#fn:5&quot; class=&quot;footnote&quot;&gt;5&lt;/a&gt;&lt;/sup&gt;，只需要执行：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;curl -sSL https://get.docker.com/ | sh
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;PS：起初，我使用的是比较新的 Ubuntu 16.04 LTS 镜像，在此强烈不推荐。这个版本和 systemd 之间有某种问题。本想着轻松无脑地安装完毕，结果就在 docker-engine 处卡住了。找了好久，才在 StackOverflow 找到&lt;a href=&quot;http://stackoverflow.com/questions/37227349/unable-to-start-docker-service-in-ubuntu-16-04/37640824#37640824&quot; target=&quot;_blank&quot;&gt;解决方法&lt;/a&gt;。&lt;/p&gt;

&lt;h2 id=&quot;section-1&quot;&gt;制作镜像&lt;/h2&gt;

&lt;p&gt;根据功能来说，需要起三个 Container 分别包含服务：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Nginx, HTTPS 证书和更新部署程序&lt;/li&gt;
  &lt;li&gt;Shadowsocks 服务&lt;/li&gt;
  &lt;li&gt;L2TP VPN 服务&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;需要为每个服务制作一个镜像。其实，这些常见服务网络上都有制作好的镜像，这也是 Docker 软件分发优势的一个体现。为了让事情不那么快餐，我决定自制一个。为了简单，这里只详细说下 Shadowsocks 部分。其中，L2TP VPN 的镜像极为复杂，因此采用了 GitHub 上找的 &lt;a href=&quot;https://github.com/hwdsl2/docker-ipsec-vpn-server&quot;&gt;hwdsl2/docker-ipsec-vpn-server&lt;/a&gt;。&lt;/p&gt;

&lt;p&gt;镜像是通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;Dockerfile&lt;/code&gt; 实现，是一种类似 Shell 的描述文件：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;FROM ubuntu:trusty
MAINTAINER David Zhang &amp;lt;crispgm@gmail.com&amp;gt;
RUN apt-get update \
    &amp;amp;&amp;amp; apt-get install -y python-pip \
    &amp;amp;&amp;amp; pip install shadowsocks

COPY etc/shadowsocks.json /etc/shadowsocks.json

EXPOSE 2968

CMD /usr/local/bin/ssserver -c /etc/shadowsocks.json -d start
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Dockerfile 很容易懂，主要是一些声明以及安装的一些过程，稍微阅读一下&lt;a href=&quot;https://docs.docker.com/engine/reference/builder/&quot;&gt;指令文档&lt;/a&gt;即可。&lt;/p&gt;

&lt;p&gt;镜像基于 &lt;code class=&quot;highlighter-rouge&quot;&gt;ubuntu:trusty&lt;/code&gt;，这个版本跟 Linode 上的系统版本并没有什么必然联系。Shadowsocks 在 pip 上，因此安装步骤异常简单。最后，把配置文件 &lt;code class=&quot;highlighter-rouge&quot;&gt;COPY&lt;/code&gt; 进去，再 &lt;code class=&quot;highlighter-rouge&quot;&gt;EXPOSE&lt;/code&gt; 端口。&lt;code class=&quot;highlighter-rouge&quot;&gt;CMD&lt;/code&gt; 是 Container 启动后执行的命令。&lt;/p&gt;

&lt;h2 id=&quot;container&quot;&gt;启动 Container&lt;/h2&gt;

&lt;p&gt;完成编写后，就可以进行 Build：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;docker build -t crisp/shadowsocks .
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;然后使用守护模式运行：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;docker run --name ssserver -d -p 2968:2968 crisp/shadowsocks
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;执行 Docker 的 &lt;code class=&quot;highlighter-rouge&quot;&gt;ps&lt;/code&gt; 指令后，发现 Container 起来就挂掉了：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ docker ps
CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Docker 在运行时必须有前台程序，不能单独就运行一个守护进程。当然，我们可以使用 Shadowsocks 的非守护模式运行。但常见的 Server 程序大多都是以守护进程运行的，因此，采用了一个小技巧：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;CMD /usr/local/bin/ssserver -c /etc/shadowsocks.json -d start \
    &amp;amp;&amp;amp; tail -f /var/log/shadowsocks.log
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;这样，前台就会因为 &lt;code class=&quot;highlighter-rouge&quot;&gt;tail&lt;/code&gt; 命令的存在而保持运行。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ docker ps
CONTAINER ID IMAGE             COMMAND                CREATED      STATUS      PORTS                  NAMES
81f57c6c0710 crisp/shadowsocks &quot;/bin/sh -c '/usr/loc&quot; 22 hours ago Up 22 hours 0.0.0.0:2967-&amp;gt;2968/tcp ssserver
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;到此，“容器化”改造顺利完成。附上相关 &lt;a href=&quot;https://github.com/crispgm/docker&quot;&gt;Dockerfiles&lt;/a&gt;.&lt;/p&gt;

&lt;h1 id=&quot;section-2&quot;&gt;结论&lt;/h1&gt;

&lt;p&gt;比起更加底层的服务器虚拟化技术，Docker 是以应用程序为中心的虚拟化技术，它提供了标准可交付的软件。通过 Docker，我们可以快速构建出资源隔离的、安全的、不同的软件服务。&lt;/p&gt;

&lt;p&gt;此外，它在持续集成和持续交付上也有着很大潜力，未来会持续跟进探索。&lt;/p&gt;

&lt;hr /&gt;

&lt;div class=&quot;footnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:1&quot;&gt;
      &lt;p&gt;Enable HTTPS with Let’s Encrypt. &lt;a href=&quot;https://crispgm.com/page/enable-https-with-letsencrypt.html&quot;&gt;https://crispgm.com/page/enable-https-with-letsencrypt.html&lt;/a&gt;. &lt;a href=&quot;#fnref:1&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:2&quot;&gt;
      &lt;p&gt;Prepare for removal of PPTP VPN before you upgrade to iOS 10 and macOS Sierra. &lt;a href=&quot;https://support.apple.com/en-us/HT206844&quot;&gt;https://support.apple.com/en-us/HT206844&lt;/a&gt;. &lt;a href=&quot;#fnref:2&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:4&quot;&gt;
      &lt;p&gt;Container技术和服务器虚拟化是一样的技术吗？&lt;a href=&quot;http://dockone.io/question/5&quot;&gt;http://dockone.io/question/5&lt;/a&gt;. &lt;a href=&quot;#fnref:4&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:3&quot;&gt;
      &lt;p&gt;Docker on Linode. &lt;a href=&quot;https://blog.linode.com/2014/01/03/docker-on-linode/&quot;&gt;https://blog.linode.com/2014/01/03/docker-on-linode/&lt;/a&gt;. &lt;a href=&quot;#fnref:3&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:5&quot;&gt;
      &lt;p&gt;Docker Quick Reference. &lt;a href=&quot;https://www.linode.com/docs/applications/containers/docker-quick-reference-cheat-sheet&quot;&gt;https://www.linode.com/docs/applications/containers/docker-quick-reference-cheat-sheet&lt;/a&gt;. &lt;a href=&quot;#fnref:5&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;
</description>
        <pubDate>Sun, 18 Sep 2016 00:00:00 +0800</pubDate>
        <link>https://crispgm.com/page/containerize-my-vps.html</link>
        <guid isPermaLink="true">https://crispgm.com/page/containerize-my-vps.html</guid>
        
        <category>Docker</category>
        
        <category>Linode</category>
        
        <category>VPS</category>
        
        <category>DevOps</category>
        
        
      </item>
    
      <item>
        <title>Awesome Coffee Shops in Beijing</title>
        <description>&lt;p&gt;Coffee is one of &lt;a href=&quot;/things.html&quot;&gt;my favorite things&lt;/a&gt; and an important source of daily energy, which help me keep focus on work and be productive. I usually drink two cups of coffee provided by the company I serve every work day. And at the weekends, we need awesome coffee shops in Beijing city.&lt;/p&gt;

&lt;p&gt;The data is powered by a open source project that I have contribute to all the time. It is called &lt;a href=&quot;https://github.com/ElaWorkshop/awesome-cn-cafe&quot;&gt;awesome-cn-cafe&lt;/a&gt;, which is a curated list of awesome café places in China. Currently, Beijing, Shanghai, Nanjing, Wuhan, Hangzhou, Guangzhou and Shenzhen are included.&lt;/p&gt;

&lt;div class=&quot;text-center&quot;&gt;
&lt;script src=&quot;https://embed.github.com/view/geojson/ElaWorkshop/awesome-cn-cafe/master/beijing.geojson&quot;&gt;&lt;/script&gt;
&lt;/div&gt;

&lt;p&gt;Please star or contribute to the project if you like it.&lt;/p&gt;

&lt;p&gt;Happy coffeeing!&lt;/p&gt;
</description>
        <pubDate>Thu, 15 Sep 2016 00:00:00 +0800</pubDate>
        <link>https://crispgm.com/page/awesome-coffee-shops-in-beijing.html</link>
        <guid isPermaLink="true">https://crispgm.com/page/awesome-coffee-shops-in-beijing.html</guid>
        
        <category>awesome</category>
        
        <category>coffee</category>
        
        <category>coffeeshop</category>
        
        
      </item>
    
      <item>
        <title>名言警句摘录</title>
        <description>&lt;p&gt;记录一些，在阅读时，获得的一些有用或是有趣的句子或段落。&lt;/p&gt;

&lt;p&gt;注：排序是以我阅读的时间升序为准，会不时更新。&lt;/p&gt;

&lt;h2 id=&quot;section&quot;&gt;摘录&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;p&gt;“电梯演讲”是风险投资行业的行话，意思是“给你30秒的时间，看你能不能用你的商业构想打动我”。&lt;sup id=&quot;fnref:1&quot;&gt;&lt;a href=&quot;#fn:1&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;这样的格局比较适合传统的产品经理，他们通常对“网络图”以及“甘特图”驾轻就熟，在看过一场令人眼花缭乱的PPT（幻灯片）演示后，他们看着投射出的高于投资收益率的财务回报率，对管理团队认可的“正式计划”的具体实施方案大加评论。他们的任务，就是按照制订好的计划行事、带领大家克服一切困难、用所谓的“发散思维”思考问题、对首席执行官的朝令夕改阿谀逢迎、想方设法地让自己的团队迎合高层的决定。&lt;sup id=&quot;fnref:1:1&quot;&gt;&lt;a href=&quot;#fn:1&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;当然，我们也有搞砸的时候。萨拉尔·卡曼加曾对我们一位年轻的市场专员印象深刻，想把他调到助理产品经理项目里。不巧的是，这个项目只接收有计算机科学学位的人，因此这位市场专员并不符合条件。萨拉尔据理力争，说这位年轻人是自学成才的程序员，还拥有“与工程师密切合作及与物流相关的经验”，但包括乔纳森在内的几位说了算的高管仍然坚持己见，他们不愿意把光圈调大，否决了这位年轻人的调职的请求。这位名叫凯文·希斯特罗姆的市场专员最终选择离开谷歌，与他人共同成立了一家名叫 Instagram 的公司，之后又以10亿美元的价格卖给了脸谱网。凯文，好样的！&lt;sup id=&quot;fnref:1:2&quot;&gt;&lt;a href=&quot;#fn:1&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;如果会议上所有人一致点头，这并不意味着大家意见一致，而只是说明你下面坐着一群“摇头娃娃”。&lt;sup id=&quot;fnref:1:3&quot;&gt;&lt;a href=&quot;#fn:1&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;驱使这样的实业家推动世界进步的，通常不是名利，而是强烈的使命感和充满个人英雄主义的梦想和野望，以及在极少数人身上可贵地伴随终生的好奇心。&lt;sup id=&quot;fnref:2&quot;&gt;&lt;a href=&quot;#fn:2&quot; class=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;Less is more.&lt;sup id=&quot;fnref:3&quot;&gt;&lt;a href=&quot;#fn:3&quot; class=&quot;footnote&quot;&gt;3&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;我们有最好的人工智能，有最好的计算机硬件，有最好的精密机械。这个团队可以完成任何事情。这也是典型的以色列风格——有一支由高素质的专业人才组成的小型精英团队，他们一同为了一个共同的目标夜以继日地工作。梅蒂诺(Medinol)是这支相同的主旋律的一段变奏曲，在梅蒂诺，一个人要处理包括他自己在内的公司的所有事务：生物、医学、工程、计算机科学以及精密机械。在美国的大企业里，让一个程序员理解血管生物学或者让一个医生理解材料工程，几乎是不可能的事情。所以，最后的决议需要协商拟定通过，这是一个繁琐而不精确的过程。但是在梅蒂诺，这是综合的，就像Orbotech是一个完全跨学科的公司一样。时间被节省下来，效率则提升至原来的三倍。&lt;sup id=&quot;fnref:4&quot;&gt;&lt;a href=&quot;#fn:4&quot; class=&quot;footnote&quot;&gt;4&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;计算机内部的风扇有悖于禅意，它们的噪音让人无法集中精神。&lt;sup id=&quot;fnref:5&quot;&gt;&lt;a href=&quot;#fn:5&quot; class=&quot;footnote&quot;&gt;5&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;section-1&quot;&gt;来源&lt;/h2&gt;

&lt;div class=&quot;footnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:1&quot;&gt;
      &lt;p&gt;《重新定义公司:谷歌是如何运营的》(How Google Works)，埃里克·施密特、乔纳森·罗森博格 (Eric Schmidt &amp;amp; Jonathan Rosenberg)。 &lt;a href=&quot;#fnref:1&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt; &lt;a href=&quot;#fnref:1:1&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;sup&gt;2&lt;/sup&gt;&lt;/a&gt; &lt;a href=&quot;#fnref:1:2&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;sup&gt;3&lt;/sup&gt;&lt;/a&gt; &lt;a href=&quot;#fnref:1:3&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;sup&gt;4&lt;/sup&gt;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:2&quot;&gt;
      &lt;p&gt;罗永浩 &lt;a href=&quot;#fnref:2&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:3&quot;&gt;
      &lt;p&gt;Ludwig Mies van der Rohe &lt;a href=&quot;#fnref:3&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:4&quot;&gt;
      &lt;p&gt;《我的应许之地》(My Promised Land: The Triumph and Tragedy of Israel)，阿里·沙维特 (Ari Shavit)。 &lt;a href=&quot;#fnref:4&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:5&quot;&gt;
      &lt;p&gt;《史蒂夫·乔布斯传》（Steve Jobs），沃尔特·艾萨克森 (Walter Isaacson)。 &lt;a href=&quot;#fnref:5&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;
</description>
        <pubDate>Sat, 03 Sep 2016 00:00:00 +0800</pubDate>
        <link>https://crispgm.com/page/collection-of-aphorisms.html</link>
        <guid isPermaLink="true">https://crispgm.com/page/collection-of-aphorisms.html</guid>
        
        <category>名言警句</category>
        
        <category>摘录</category>
        
        
      </item>
    
      <item>
        <title>Ruby 相见恨晚</title>
        <description>&lt;p&gt;大学时因为好奇的原因在图书馆借阅过几次 Ruby 和 Ruby on Rails 的书籍，大概是道行不够的原因，完全体会不到它的优点。&lt;/p&gt;

&lt;p&gt;两个月前，因为 &lt;a href=&quot;https://jekyllrb.com/&quot;&gt;Jekyll&lt;/a&gt; 接触到了 Ruby，并且成为了 Jekyll 的忠实贡献者。之后，不仅所有的个人做的网站都变成了 “Powered by Jekyll”，还学会了 Jekyll 整个 Project 极致的自动化工具链。Jekyll 通过测试驱动 (TDD, Test Driven Development) 覆盖 lib 层功能，通过行为驱动 (BDD, Behavior Driven Development) 回归整体功能，并在 Travis 和 AppVeyor 分别进行 Linux 环境和 Windows 环境下的持续集成。Jekyll 还通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;rake&lt;/code&gt; 实现同个 Project 下网站部分的生成发布到 &lt;code class=&quot;highlighter-rouge&quot;&gt;gh-pages&lt;/code&gt; 分支、发布时从打包到上传 &lt;code class=&quot;highlighter-rouge&quot;&gt;gem push&lt;/code&gt; 等操作。甚至说，Jekyll 的维护者还引入了一个账户名为 jekyllbot 的机器人完成 PR Merge、追加 Changelog、Issues/PR 自动分配 assignee 和发布 Releasenotes 等工作。&lt;/p&gt;

&lt;p&gt;现在，我的网站也成为了自动化工具链的受益者，使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;rake&lt;/code&gt; 来自动完成生成博客和生成简历等各项操作，并且通过 GitHub Webhooks 自动触发更新部署。&lt;/p&gt;

&lt;p&gt;受到自动化的 Workflow 以及红火发展的聊天机器人和 ChatOps 的启发，我发起了 &lt;a href=&quot;https://github.com/crispgm/heelbot&quot;&gt;Heelbot&lt;/a&gt; 项目来建设自己的自动化工具链和 Workflow，并能够完成聊天机器人的工作。Jekyll 在测试方面的做法被引入了 Heelbot 的自动化测试中，结合应用了 TDD 和 BDD，以后有时间会专门写文章讲述。达成的结果就是，改过代码后，不需要手动操作任何东西，只需要跑一次测试脚本，就可以完成对底层库和整体功能的测试及回归。&lt;/p&gt;

&lt;p&gt;然后，我买了 Matz 的两本书：《松本行弘的程序世界》和《代码的未来》，了解 Ruby 的设计背景和哲学。Matz 对于编程语言的设计有着很深刻的理解，阐述了 Ruby 在各种语法中设计的思路和取舍，尤其是对于面向对象、多继承问题 (mixin) 和 &lt;code class=&quot;highlighter-rouge&quot;&gt;block&lt;/code&gt; 这几方面。&lt;/p&gt;

&lt;p&gt;对 Ruby 最大的感受就是整体体验很舒服，其次就是生态非常完善。Ruby 的舒服体现在方方面面，无论是语法、生态还是库接口的设计。使用 Ruby，你得到的就是完善的生态，包括 RubyGems 包管理机制、Bundler 依赖管理、Ruby-Doc 库文档平台等。而不是一个编译器或者是解析器。现在各种包管理器已经成为了标配，各种新老语言理所当然的都包含了自己的包管理系统，如 Python 的 pip，Node.js 的 NPM，Rust 的 Cargo 之类。但 RubyGems 早在 &lt;strong&gt;2003&lt;/strong&gt; 就被创立了！&lt;/p&gt;

&lt;p&gt;内在的体验就是，Ruby 的程序员很有自己的思想，尤其是在“如何利用高级语言更好、更优雅、更舒服、更高效的编程”这个主题上。因此，在这些主题相关的领域，在 Ruby 上的发展都非常完善，即使 Ruby 整体的人气和我原来常用的 PHP 有一定差距。当然，Ruby 本身灵活动态的语法和自身的一些特性，也让开发的便捷成为了可能。&lt;/p&gt;

&lt;p&gt;但国内很多 PHP 程序员却不那么关注这块。就我对狼厂 PHP 程序员们的了解，他们往往心中想着“高并发”、“性能”、“分布式”等“高大上”的主题，本质上对“世界上最好的语言”并无多大好感，只是造化弄人不得不写罢了。他们最希望的是什么时候能够改用性能更好的底层的语言——老牌的 C/C++ 或者 Golang，甚至说在脚本语言中也希望能用上更优雅飘逸的 Python 什么的。&lt;/p&gt;

&lt;p&gt;我承认，我起初也是这样的人，也对 PHP 没什么兴趣。但不用多长时间，每个任何语言的使用者可以发现几个事实（或许不会承认）：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;不是所有程序都需要自身执行效率很高，有些只是希望开发效率高&lt;/li&gt;
  &lt;li&gt;用 C/C++ 或 Golang 或某些框架写出了表现“很牛”程序，那是人家自身的优势，和程序员本人关系不大&lt;/li&gt;
  &lt;li&gt;不管用什么语言，都需要一些软素质，其中很重要的一块就是“代码可维护性”&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;这是氛围上带来的某种误区，奥运会并不是只有赛跑，，做得最成功的产品也很可能不是响应时间最低的。&lt;/p&gt;

&lt;p&gt;作为 Web 产品研发工程师，我觉得在产品迭代中，排除掉对业务和体验的关心外，在纯技术事务上，工程师更应该关注的是开发效率和代码可维护性。性能当然需要时刻考虑，但这只是工程师追求的一小块。但事实是，性能被过多考虑了，而在协同环境中会提供更大收益的代码可维护性却被忽略了。我们有时循规蹈矩用着刀耕火种式的开发模式，然后轻易地就放弃了文档、自动化测试、Code Review 等环节。软素质问题日益阻碍着团队的发展。&lt;/p&gt;

&lt;p&gt;代码可维护性是衡量一个程序员 craftmanship 的重要指标，这也是 Rubyist 哲学中很重视的一块。因此，他们发明或实现了很多理念上领先的东西提高可维护性。比如：Ruby on Rails，它当然比 Sinatra/&lt;a href=&quot;https://github.com/laruence/yaf&quot;&gt;yaf&lt;/a&gt; 这样的框架重、复杂、不易入门，但却能得到真正的极致的开发效率。&lt;/p&gt;

&lt;p&gt;因此，更加精英化的外国初创企业很流行使用 Ruby on Rails 作为后端解决方案。比如：Twitter, Airbnb, GitHub, Shopify 等。&lt;/p&gt;

&lt;p&gt;End.&lt;/p&gt;
</description>
        <pubDate>Sun, 28 Aug 2016 00:00:00 +0800</pubDate>
        <link>https://crispgm.com/page/regret-not-meet-ruby-before.html</link>
        <guid isPermaLink="true">https://crispgm.com/page/regret-not-meet-ruby-before.html</guid>
        
        <category>Ruby</category>
        
        
      </item>
    
      <item>
        <title>深入 Jekyll</title>
        <description>&lt;h1 id=&quot;section&quot;&gt;介绍&lt;/h1&gt;

&lt;p&gt;Jekyll 是一个为博客设计的静态网站生成器，也可以用于个人、项目或组织的网站构建。可以认为，Jekyll 是一个基于文件的内容管理系统（CMS）。它使用 Ruby 编写，通过 Markdown 和 Liquid 模板生成内容。&lt;/p&gt;

&lt;p&gt;有了 Jekyll 这类静态博客生成工具，我们不再需要使用动态语言开发和运行后端程序（如：Wordpress 和 Drupal 等），而只是需要一个静态 HTTP Server。甚至，在有了 GitHub Pages 后，连服务器资源都可以省去。当然，静态网站的好处不止是节省资源，还有安全、速度、扩展性等考虑。具体可以阅读文章：&lt;a href=&quot;https://www.netlify.com/blog/2016/05/18/9-reasons-your-site-should-be-static&quot;&gt;https://www.netlify.com/blog/2016/05/18/9-reasons-your-site-should-be-static&lt;/a&gt;。&lt;/p&gt;

&lt;p&gt;美国总统奥巴马连任时的竞选 &lt;a href=&quot;http://kylerush.net/blog/meet-the-obama-campaigns-250-million-fundraising-platform/&quot;&gt;Campaign&lt;/a&gt; 网站就使用 Jekyll 开发。ps：不过，希拉里的技术团队又退回到了动态网站。&lt;/p&gt;

&lt;p&gt;GitHub Pages 的背后就运行着 Jekyll，而 Jekyll 本身也是由 GitHub co-founder、前 CEO Tom Preston-Werner(@mojombo) 创立，目前由 Parker Moore(@parkr) 维护，他本人也于&lt;a href=&quot;https://byparker.com/blog/2016/joining-github/&quot;&gt;2016年初加入了 GitHub&lt;/a&gt;。&lt;/p&gt;

&lt;p&gt;在 GitHub 的支持下，Jekyll 社区一直保持着极为活跃的状态，Jekyll 的 GitHub Repo 每天都处于更新的状态。近期，刚刚发布了 3.2.0 版本，开始支持基于 RubyGems 的主题。&lt;/p&gt;

&lt;p&gt;但 3.2.0 版和作为修补的 3.2.1 版本生态还不是很完善，原有的主题大多还没有完成 Gem 化改造。官方目前没有主题分享的网站，第三方主题资源分享网站也基本都没有升级，所以反而难以用新的方式选择主题。&lt;/p&gt;

&lt;p&gt;此外，主题 Gem 化带来的好处主要是主题分发的便捷性，但如果需要动手改动主题中的 css 或者 &lt;code class=&quot;highlighter-rouge&quot;&gt;_layouts&lt;/code&gt; 文件，就比较麻烦。&lt;/p&gt;

&lt;p&gt;所以在短期内，我还是比较推荐使用上一个稳定的版本——3.1.6 版的模式。当然，即使程序是 3.2.1 版本也可以按旧的方式来使用，因为 Jekyll 是向下兼容的。&lt;/p&gt;

&lt;h1 id=&quot;section-1&quot;&gt;快速入门&lt;/h1&gt;

&lt;p&gt;对于 Jekyll 本身和 GitHub Pages，由于市面上此类教程很多，本文就不重复造轮子了。可以阅读：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.ruanyifeng.com/blog/2012/08/blogging_with_jekyll.html&quot;&gt;搭建一个免费的，无限流量的Blog—-github Pages和Jekyll入门&lt;/a&gt;, by ruanyifeng&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://jekyllrb.com/docs/home/&quot;&gt;Jekyll 官方文档&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;jekyll&quot;&gt;深入 Jekyll&lt;/h1&gt;

&lt;p&gt;Jekyll 和一般的 Ruby 程序一样，设计思想上易用性强入门简单。但 Jekyll 其实还可以有很多超频的能力。&lt;/p&gt;

&lt;p&gt;我们可以使用 Jekyll Data Files 实现读取 Key-Value 数据库的功能，可以创建和传播自己的主题样式，并且可以结合 Liquid 模板系统创建多种类型的插件。&lt;/p&gt;

&lt;h2 id=&quot;jekyll-data-files&quot;&gt;Jekyll Data Files&lt;/h2&gt;

&lt;p&gt;Jekyll 虽然无法像动态网站程序一样读取数据库，但它提供了一种读取静态数据的方式，就是 Jekyll Data Files。&lt;/p&gt;

&lt;p&gt;我们可以在 Jekyll Data Files 中使用 YAML, JSON 或 CSV 格式的文件，实现类似动态配置的效果。这些数据会被解析成变量 &lt;code class=&quot;highlighter-rouge&quot;&gt;site.data.your_data&lt;/code&gt; 在 Liquid 模板中使用。&lt;/p&gt;

&lt;h2 id=&quot;jekyll-themes&quot;&gt;Jekyll Themes&lt;/h2&gt;

&lt;p&gt;Jekyll 主题在支持 RubyGems 前，需要通过复制来实现。很简单粗暴，就是把已经做好的 &lt;code class=&quot;highlighter-rouge&quot;&gt;_config.yml&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;_includes&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;_layouts&lt;/code&gt; 和相关静态文件一起复制到自己的目录中。&lt;/p&gt;

&lt;p&gt;Jekyll 原生支持 sass，并且也可以通过插件形式使用 Less 等其它的 CSS 预处理器。&lt;/p&gt;

&lt;p&gt;官方目前没有主题分享的网站，第三方主题资源分享网站还算比较丰富，甚至已经有了不少付费的主题。不过，这些网站都还没有迁移成 RubyGems。&lt;/p&gt;

&lt;p&gt;3.2.0 版发布后，Jekyll 支持了 &lt;code class=&quot;highlighter-rouge&quot;&gt;jekyll new-theme&lt;/code&gt; 指令，可以方便的创建自己的主题，并且发布到 RubyGems。有兴趣自制主题的 geeks，可以贡献出自己的主题。&lt;/p&gt;

&lt;h2 id=&quot;liquid-templates&quot;&gt;Liquid Templates&lt;/h2&gt;

&lt;p&gt;Jekyll 的底层模板层渲染基于开源 Ruby 库 &lt;a href=&quot;https://shopify.github.io/liquid/&quot;&gt;Liquid&lt;/a&gt; 实现。这是一个 &lt;a href=&quot;https://www.shopify.com/&quot;&gt;Shopify&lt;/a&gt; 公司开源出来的模版系统，用于 Shopify 的店铺主题系统。&lt;/p&gt;

&lt;p&gt;Liquid 提供 Objects(对象)，Tags(标签)和 Filters(过滤器) 三种类型的模板标记。&lt;/p&gt;

&lt;h4 id=&quot;objects&quot;&gt;Objects&lt;/h4&gt;

&lt;p&gt;&lt;strong&gt;Objects&lt;/strong&gt; 就是传统意义上的模板变量，用双大括号包围。Jekyll 就是将文件中解析的各种内容，通过 Liquid Objects 注入给展示层。&lt;/p&gt;

&lt;p&gt;如下，表示页面的标题：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;page.title&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;tags&quot;&gt;Tags&lt;/h4&gt;

&lt;p&gt;&lt;strong&gt;Tags&lt;/strong&gt; 主要用于提供逻辑功能和控制流，Liquid 自带的 Tags 大多都是控制流和变量相关的，如：if/foreach/assign/capture 之类的。但 Tags 实际上可以用作增加新的标签，作为逻辑功能函数的感觉。&lt;/p&gt;

&lt;p&gt;Jekyll 就有一种扩展是通过扩展 Liquid Tags 来实现。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;Hello&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;user.name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;}!&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;endif&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;filters&quot;&gt;Filters&lt;/h4&gt;

&lt;p&gt;&lt;strong&gt;Filters&lt;/strong&gt; 写法和效果都可以类比于 Shell 中的 Pipe 模式。输出的变量，通过管道符传递进行链式处理。Jekyll 官方扩展了一批 Liquid Filters 配合 Liquid Objects，便于实现博客系统。如：博客的排序、日期的格式化等。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;/my/fancy/url&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.html&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;注：以上例子均取自 &lt;a href=&quot;https://shopify.github.io/liquid/basics/introduction/&quot;&gt;Liquid 官方文档&lt;/a&gt;。&lt;/p&gt;

&lt;h2 id=&quot;jekyll-plugins&quot;&gt;Jekyll Plugins&lt;/h2&gt;

&lt;p&gt;Jekyll 支持多种扩展方式，分别是 Generators, Converters, Commands, Tags, Filters 和 Hooks。其中一些是 Jekyll 自身的扩展机制，而 Tags/Filters 则实质上是对 Liquid Tags/Filters 进行扩展。&lt;/p&gt;

&lt;p&gt;扩展可以通过 Gem 或本地文件分发使用，这块的生态比较杂，主要还是通过 Jekyll 主页 &lt;a href=&quot;https://jekyllrb.com/docs/plugins/&quot;&gt;Jekyll Plugins 文档&lt;/a&gt;的专门区域分享插件。对于插件开发者来说，完成开发后可以发 PR 修改 Jekyll Plugins 页面把你的插件分享出来，一般都会被准许 merge（&lt;del&gt;想骗贡献的速来&lt;/del&gt;）。&lt;/p&gt;

&lt;p&gt;我自己也写了一个 Jekyll Plugin，名叫 jekyll-taglist。这是一个 &lt;code class=&quot;highlighter-rouge&quot;&gt;Liquid Tags&lt;/code&gt; 扩展，其作用是收集并输出文章的标签 &lt;code class=&quot;highlighter-rouge&quot;&gt;page.tags&lt;/code&gt; 和其计数，支持对标签的条件选择、过滤和排序。输出后，我们可以通过 CSS 实现一些展示效果。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# 设定条件：
# - 阈值为1
# - 显示计数
# - 使用计数进行降序排序
# - 限制为30个

{% tags_list :threshold =&amp;gt; 1, :show_count =&amp;gt; 1, :sort_by =&amp;gt; count, :order_by =&amp;gt; desc, :limit =&amp;gt; 30 %}
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;输出后的效果在我的网站&lt;a href=&quot;https://crispgm.com/blogs.html&quot;&gt;博客页底部&lt;/a&gt;。&lt;/p&gt;

&lt;p&gt;有兴趣可以到 &lt;a href=&quot;https://github.com/crispgm/jekyll-tags-list-plugin&quot;&gt;https://github.com/crispgm/jekyll-tags-list-plugin&lt;/a&gt; 详细了解。&lt;/p&gt;

&lt;h1 id=&quot;jekyll-&quot;&gt;Jekyll 社区&lt;/h1&gt;

&lt;p&gt;由于受到 GitHub 官方的支持，Jekyll 在静态博客生成器中应该说是最热门的。这或许也是 Jekyll 的社区非常繁荣的原因。它迭代很快，维护者对 Issues 和 PRs 的处理也很快。&lt;/p&gt;

&lt;p&gt;在工程方面，Jekyll 的自动化测试覆盖率非常高，既有基于 Cucumber 实现的 Bahavior Driven Test，也有一般的 Unit Test，通过常见的 Travis-CI 完成持续集成回归。还集成有 Code Climate 代码规范检测（通过 Rubocop 实现），代码测试覆盖率检测。目前，Jekyll 正在积极接入 AppVeyor，也就是 Windows 领域的 Travis-CI。很快即将实现多端（类 Unix 系统，如Linux/Mac 和 Windows 系统）、多平台（原生 Ruby 和 JRuby）自动化回归。&lt;/p&gt;

&lt;p&gt;Jekyll 不仅测试做到了自动化，还做到了整体工作流的自动化。Jekyll 启用了 @jekyllbot 辅助项目维护团队：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Merge PR：通过在 PR 中 &lt;code class=&quot;highlighter-rouge&quot;&gt;@jekyllbot: merge +site&lt;/code&gt; 控制合并，并且在合并后机器人会自动根据后缀内容（+site 代表这个 PR 是对网站文档进行的修改）将变更分类加入到 changelog 中。&lt;/li&gt;
  &lt;li&gt;版本发布：会在 GitHub 打 tag 并发布 release，release 内容会从更新列表中拉取；自动更新并 push gemspec 文件到 RubyGems；获取这个版本内的所有变更贡献者，加入到版本发布新闻的感谢列表中。&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;section-2&quot;&gt;启发&lt;/h1&gt;

&lt;p&gt;受到了 Jekyll 的启发，我也进行了很多关于工作流自动化方面的思考。主要做了几件小事：&lt;/p&gt;

&lt;h4 id=&quot;section-3&quot;&gt;博客自动化部署&lt;/h4&gt;

&lt;p&gt;由于种种原因，我的博客并没有部署在 GitHub Pages 上，而是独立的主机。因此，在 push 到 GitHub 之后还需要部署到主机中。我们可以在主机上起一个代码更新部署进程，在 push 后通过 GitHub WebHooks 回调主机上的更新接口，实现自动化部署。这样，只要一 push 代码就会触发主机上的更新。&lt;/p&gt;

&lt;p&gt;为了让 push 本身更容易，又通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;Rakefile&lt;/code&gt; 将 &lt;code class=&quot;highlighter-rouge&quot;&gt;jekyll build&lt;/code&gt; 和 push 也自动化，完成 build 之后自动提交如：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;git commit -m &quot;Deployed at 2016-08-18 14:50:26 +0800&quot;

git push origin master
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;section-4&quot;&gt;日报/周报邮件模板&lt;/h4&gt;

&lt;p&gt;日常工作中，需要每天或每周发送各类日报和周报。发送的内容一般会维护在某个表格或文档中，但邮件的收件人和抄送都是固定的一类人，标题则是标题+时间的格式，正文会有开头问好和结尾签名。这恰好是模板类需求，可以用 Liquid 实现。&lt;/p&gt;

&lt;p&gt;对于邮件人和抄送人，建立一些 Group，并且通过 Liquid Tags 返回这些人的邮件地址。如：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;to: '{% group_members tech_core members %}'
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;对于标题，则使用 Liquid Objects 传入时间等变量，并使用 Liquid Filters 将时间转换为合适的样式。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;title: '项目日报 {{ created_time | date: &quot;%Y%m%d&quot; }}' 
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
</description>
        <pubDate>Thu, 18 Aug 2016 00:00:00 +0800</pubDate>
        <link>https://crispgm.com/page/dive-into-jekyll.html</link>
        <guid isPermaLink="true">https://crispgm.com/page/dive-into-jekyll.html</guid>
        
        <category>Jekyll</category>
        
        <category>Ruby</category>
        
        <category>GitHub</category>
        
        <category>Blog</category>
        
        <category>Markdown</category>
        
        <category>Liquid</category>
        
        
      </item>
    
      <item>
        <title>开源项目中使用 git-rebase 合并提交</title>
        <description>&lt;p&gt;最近，在 GitHub 上贡献代码时，常常是在本地提交 &lt;code class=&quot;highlighter-rouge&quot;&gt;git commit&lt;/code&gt; 很多次后才发起 PR。亦或是在发起 PR 后，又因为功能、自动化测试、代码风格等原因，进行了几次修复性质的 commits。&lt;/p&gt;

&lt;p&gt;当维护者完成 Code Review 之后，往往就会提出类似这样的要求：&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;LGTM after a quick rebase!&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;Can you squash the git commits, otherwise LGTM.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;这是维护者要求提交者使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;git rebase&lt;/code&gt; 将自己的所有提交合并成一条。&lt;/p&gt;

&lt;h1 id=&quot;git-rebase&quot;&gt;什么是 git-rebase&lt;/h1&gt;

&lt;p&gt;&lt;a href=&quot;https://git-scm.com/docs/git-rebase&quot;&gt;git-rebase&lt;/a&gt; 的定义是：&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;git-rebase - Reapply commits on top of another base tip&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;rebase 的官方中文翻译是“衍合”，意思是在另一个起点上重新应用提交。深入的具体用法可以参考 &lt;a href=&quot;https://git-scm.com/book/zh/v1/Git-%E5%88%86%E6%94%AF-%E5%88%86%E6%94%AF%E7%9A%84%E8%A1%8D%E5%90%88&quot;&gt;Git 官方文档&lt;/a&gt;。&lt;/p&gt;

&lt;p&gt;对于当前的应用场景，rebase 的意义是把提交合成一个，这样对于你提交的一个功能，只会有一个提交记录，便于维护者管理。&lt;/p&gt;

&lt;h1 id=&quot;section&quot;&gt;如何操作？&lt;/h1&gt;

&lt;h2 id=&quot;editor&quot;&gt;设置Editor&lt;/h2&gt;

&lt;p&gt;首先，要确定是 Terminal 的 &lt;code class=&quot;highlighter-rouge&quot;&gt;EDITOR&lt;/code&gt;。我选择设定为 vim。&lt;/p&gt;

&lt;p&gt;修改 &lt;code class=&quot;highlighter-rouge&quot;&gt;~/.zshrc&lt;/code&gt;（非 zsh 用户可以用 &lt;code class=&quot;highlighter-rouge&quot;&gt;~/.bashrc&lt;/code&gt;），加入：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;export EDITOR='vim'
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h2 id=&quot;rebase&quot;&gt;执行 rebase&lt;/h2&gt;

&lt;p&gt;先数一数你提交过的数量，比如之前提交了5次：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;git rebase -i HEAD~5
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Git 会调起 vim，提示让你处理 commits：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pick f3e7c2e Add RIO medal count bot
pick 316f48a Add weekly template
pick 23c5c47 Move require to third party libs within implementations
pick 64cad0b Test coverage 100% for test/command
pick 030f64a Graceful require

# Rebase 2dfc82e..030f64a onto 2dfc82e (5 command(s))
#
# Commands:
# p, pick = use commit
# r, reword = use commit, but edit the commit message
# e, edit = use commit, but stop for amending
# s, squash = use commit, but meld into previous commit
# f, fixup = like &quot;squash&quot;, but discard this commit's log message
# x, exec = run command (the rest of the line) using shell
# d, drop = remove commit
#
# These lines can be re-ordered; they are executed from top to bottom.
#
# If you remove a line here THAT COMMIT WILL BE LOST.
#
# However, if you remove everything, the rebase will be aborted.
#
# Note that empty commits are commented out 
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h2 id=&quot;section-1&quot;&gt;处理提交&lt;/h2&gt;

&lt;p&gt;按 &lt;code class=&quot;highlighter-rouge&quot;&gt;i&lt;/code&gt; 进入编辑模式，常用的操作有&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;p: 选取
r: 变更提交信息
s: 将提交信息合并到上一个提交中
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;最早的一条提交是必须保留的，可以选取或者变更提交信息，但不能选择合并。对于后面几条则可以进行合并。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pick f3e7c2e Add RIO medal count bot
s 316f48a Add weekly template
s 23c5c47 Move require to third party libs within implementations
s 64cad0b Test coverage 100% for test/command
s 030f64a Graceful require
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;注：用 r 修改提交信息时，不需要在这个里面改，直接保存退出 vim 会弹出专门的修改信息文件。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;wq&lt;/code&gt; 保存后，会进入合并信息页面，再次保存后完成 rebase。&lt;/p&gt;

&lt;h2 id=&quot;push&quot;&gt;Push&lt;/h2&gt;

&lt;p&gt;进行完 rebase 后，直接执行 &lt;code class=&quot;highlighter-rouge&quot;&gt;git push origin your-branch-name&lt;/code&gt; 会失败，这时千万不要按照提示进行 &lt;code class=&quot;highlighter-rouge&quot;&gt;git pull&lt;/code&gt;，否则会触发 merge。&lt;/p&gt;

&lt;p&gt;直接使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;-f&lt;/code&gt; 参数进行强制 push：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;git push -f origin your-branch-name
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;完成 push 后，GitHub 的 PR 中，几条提交就会被合并到了同一条中。&lt;/p&gt;
</description>
        <pubDate>Tue, 16 Aug 2016 00:00:00 +0800</pubDate>
        <link>https://crispgm.com/page/git-rebase.html</link>
        <guid isPermaLink="true">https://crispgm.com/page/git-rebase.html</guid>
        
        <category>git</category>
        
        <category>GitHub</category>
        
        <category>OpenSource</category>
        
        
      </item>
    
      <item>
        <title>不同页面载入相同 Disqus 主题</title>
        <description>&lt;p&gt;我的博客采用了开源界内普遍采用的 Disqus 提供对博客的评论支持。它用起来很简单，只需要注册一个帐户获得一个 &lt;code class=&quot;highlighter-rouge&quot;&gt;Shortname&lt;/code&gt; 然后在 HTML 底部加入一段代码就可以了，Disqus 会自动抓取你的 URL 信息作为 key，在页面滑动到代码所在的区域时自动载入评论。&lt;/p&gt;

&lt;p&gt;博客从最初到现在经历了好多个阶段：&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt; &lt;/th&gt;
      &lt;th&gt;生成器&lt;/th&gt;
      &lt;th&gt;域名&lt;/th&gt;
      &lt;th&gt;托管&lt;/th&gt;
      &lt;th&gt;HTTPS&lt;/th&gt;
      &lt;th&gt;评论服务&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;第一代&lt;/td&gt;
      &lt;td&gt;PHP&lt;/td&gt;
      &lt;td&gt;新浪二级域名&lt;/td&gt;
      &lt;td&gt;Sina App Engine&lt;/td&gt;
      &lt;td&gt;不支持&lt;/td&gt;
      &lt;td&gt;无&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;第二代&lt;/td&gt;
      &lt;td&gt;PHP 自写&lt;/td&gt;
      &lt;td&gt;GitHub 二级域名&lt;/td&gt;
      &lt;td&gt;GitHub Pages&lt;/td&gt;
      &lt;td&gt;不支持&lt;/td&gt;
      &lt;td&gt;Disqus&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;第三代&lt;/td&gt;
      &lt;td&gt;PHP 自写&lt;/td&gt;
      &lt;td&gt;单个一级域名&lt;/td&gt;
      &lt;td&gt;Linode VPS&lt;/td&gt;
      &lt;td&gt;不支持&lt;/td&gt;
      &lt;td&gt;Disqus&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;第四代&lt;/td&gt;
      &lt;td&gt;PHP 自写&lt;/td&gt;
      &lt;td&gt;单个一级域名&lt;/td&gt;
      &lt;td&gt;Linode VPS&lt;/td&gt;
      &lt;td&gt;支持&lt;/td&gt;
      &lt;td&gt;Disqus&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;第五代&lt;/td&gt;
      &lt;td&gt;Jekyll&lt;/td&gt;
      &lt;td&gt;多个一级域名&lt;/td&gt;
      &lt;td&gt;Linode VPS&lt;/td&gt;
      &lt;td&gt;支持&lt;/td&gt;
      &lt;td&gt;Disqus&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;其中第三、四、五代都造成了新的页面无法载入老的评论，但 Disqus 作为一个通用的第三方评论服务，提供了多种数据迁移方式帮助我轻松解决了这类问题。&lt;/p&gt;

&lt;h3 id=&quot;url-&quot;&gt;URL 变更&lt;/h3&gt;

&lt;p&gt;Disqus 对 URL 的识别也是区分协议、域名和 Path。因此，这些元素任意一个发生了变更，都会导致“新页面”没有了原有页面上的评论。&lt;/p&gt;

&lt;p&gt;Disqus 提供了三种 URL 映射来解决这类问题。分别是：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Domain Migration Tool：域名迁移工具&lt;/li&gt;
  &lt;li&gt;Upload a URL map：上传 URL 映射表&lt;/li&gt;
  &lt;li&gt;Redirect Crawler (Advanced)：重定向抓取&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;第二代到第三代最明确，就是有了自己的域名，URL 出现了变更，故加载不到原有的评论。因此，果断采用域名迁移工具，从原来的 http://crispgm.github.io 迁移到 http://crispgm.com 上。&lt;/p&gt;

&lt;p&gt;第四代主要启用了 HTTPS，采用了 HTTPS 后的页面就会被视为与 HTTP 协议的页面完全不同的页面。由于域名迁移工具不支持更改协议，这就得用 URL 映射表方式。需要在本地创建一个 .csv 格式的 URL 映射表，然后上传后即可。同时由于一些页面 URL 的起初英文不太合理，所以后来优化后进行了一次变更，也采用这种方式。&lt;/p&gt;

&lt;h3 id=&quot;section&quot;&gt;多域名支持&lt;/h3&gt;

&lt;p&gt;第五代时，由于&lt;a href=&quot;/page/new-domain-name.html&quot;&gt;多域名&lt;/a&gt;的启用，访问不同域名下的同一个网页，其评论是分开的，各自是一个副本。&lt;/p&gt;

&lt;p&gt;Disqus 官方自带的网页可视化工具已经不能支持，需要进行&lt;a href=&quot;https://help.disqus.com/customer/portal/articles/472098-javascript-configuration-variables&quot;&gt;程序级别的参数配置&lt;/a&gt;，需在载入代码进行配置参数。&lt;/p&gt;

&lt;p&gt;于是，我修改了 Jekyll 的 &lt;code class=&quot;highlighter-rouge&quot;&gt;_layout/post.html&lt;/code&gt; 模板中的 Disqus 片段。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;var disqus_config = function () {
  this.page.url = '{{ site.url }}{{ page.permalink }}';
  this.page.identifier = '{{ page.permalink }}';
  this.page.title = '{{ page.title }}';
};
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;现在，问题终于彻底得到了解决。&lt;/p&gt;
</description>
        <pubDate>Sun, 24 Jul 2016 00:00:00 +0800</pubDate>
        <link>https://crispgm.com/page/same-disqus-thread-in-multiple-pages.html</link>
        <guid isPermaLink="true">https://crispgm.com/page/same-disqus-thread-in-multiple-pages.html</guid>
        
        <category>Disqus</category>
        
        <category>Tips</category>
        
        
      </item>
    
  </channel>
</rss>
