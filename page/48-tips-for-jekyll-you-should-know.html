<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="description" content="A minimalist programmer, photographer and lifes lover."/>
    <title>48 个你需要知道的 Jekyll 使用技巧 | David Zhang</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="canonical" href="https://crispgm.com/page/48-tips-for-jekyll-you-should-know.html">
    <link rel="alternate" href="https://crisp.lol">
    <link rel="alternate" href="https://crispgm.com/feed.xml" type="application/rss+xml" title="RSS">
    <link rel="icon" type="image/x-icon" href="https://assets-cdn.github.com/favicon.ico">
    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="stylesheet" href="/assets/css/opensans.css">
    
    
    <link rel="stylesheet" href="/assets/css/zenburn.css">
    
  </head>
  <body>
    <div id="content">
    <header class="menu">
      <div class="menu-home">
        <a href="/">DAVID ZHANG</a>
      </div>
      <div class="menu-links">
        <div class="menu-item">
          <a href="/blog.html">Blog</a>
        </div>
        <div class="menu-item">
          <a href="/project.html">Project</a>
        </div>
        <div class="menu-item">
          <a href="/favorite.html">Favorite</a>
        </div>
        <div class="menu-item">
          <a href="/about.html">About</a>
        </div>
      </div>
    </header>

<div class="article">
  <div class="article-head">
    <div class="article-title">48 个你需要知道的 Jekyll 使用技巧</div>
    <div class="article-date">November 19, 2016</div>
  </div>
  <div class="article-main">
    <p>很久以前，本人的个人博客是 PHP 写的简单页面，实时转换 Markdown。后来，为了简单，用 PHP 写了一个静态博客转换器。虽用起来还比较舒服，但通用性太差了。于是转向 GitHub Pages 官方支持的 Jekyll，没想到只花了20分钟就完成了迁移，开发体验颇好。深入使用和参与了许久后，决定写一篇 Jekyll 相关的 Tips 的文章，仅供大家参考。</p>

<p>目前还没完全写完，先发出来。</p>

<h2 id="section">简介</h2>

<h4 id="jekyll">什么是 Jekyll</h4>

<p><a href="https://jekyllrb.com/">Jekyll</a> 是一个简单的，博客感知的，静态网站生成器。</p>

<h4 id="section-1">安装</h4>

<p>首先，你得有 Ruby。对于 Mac 用户，可以使用 Homebrew 安装。</p>

<div class="highlighter-rouge"><pre class="highlight"><code>brew install ruby
</code></pre>
</div>

<p>然后：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ gem install jekyll
</code></pre>
</div>

<h4 id="gem-">Gem 安装不上或者很慢怎么办？</h4>

<p>RubyGems 是一个优秀的包管理系统，但再优秀也扛不住墙和距离，所以一般情况下，中国大陆的用户需要更换 RubyGems 的源。</p>

<p>建议更换成 Ruby-China 的源，参考 <a href="https://gems.ruby-china.org/">https://gems.ruby-china.org/</a>。</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ gem sources --add https://gems.ruby-china.org/ --remove https://rubygems.org/
</code></pre>
</div>

<p>同时，也广告一下本人的作品：<a href="https://crispgm.github.io/gsm/">Gem Sources Manager</a>，专门用于切换源。</p>

<h4 id="mac-osx-el-capitan-">Mac OSX El Capitan 安装失败</h4>

<p>从 Mac OSX El Capitan 开始，Apple 采取了一个叫 SIP 的东西保护系统文件夹，导致 <code class="highlighter-rouge">/usr/bin</code> 等文件夹无法写入。因此需要更换安装路径。</p>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo gem install -n /usr/local/bin jekyll
</code></pre>
</div>

<p>详见 <a href="https://jekyllrb.com/docs/troubleshooting/#jekyll-amp-mac-os-x-1011">https://jekyllrb.com/docs/troubleshooting/#jekyll-amp-mac-os-x-1011</a></p>

<h4 id="bundler">Bundler</h4>

<p>Jekyll 3.3.0 之后开始采用 Bundler 方式运行。安装时，需要同时安装 Bundler：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ gem install jekyll bundler
</code></pre>
</div>

<p>所以所有命令可能也需要使用 Bundler：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ bundle exec jekyll serve
</code></pre>
</div>

<h2 id="section-2">命令</h2>

<h4 id="jekyll-new-">使用 <code class="highlighter-rouge">jekyll new</code> 创建新站点</h4>

<div class="highlighter-rouge"><pre class="highlight"><code>$ jekyll new my-jekyll-site
</code></pre>
</div>

<p>也可以：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ mkdir my-jekyll-site
$ cd my-jekyll-site
$ jekyll new .
</code></pre>
</div>

<h4 id="jekyll-serve-">使用 <code class="highlighter-rouge">jekyll serve</code> 在本地运行站点</h4>

<p>以下三种使用方式是等价的：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ jekyll serve
$ jekyll server
$ jekyll s
</code></pre>
</div>

<p>通过 <code class="highlighter-rouge">http://localhost:4000</code> 进行访问。</p>

<h4 id="jekyll-build-">使用 <code class="highlighter-rouge">jekyll build</code> 生成站点</h4>

<p>以下两种使用方式是等价的：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ jekyll build
$ jekyll b
</code></pre>
</div>

<p>通过 <code class="highlighter-rouge">--destination</code> 指定目标路径：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ jekyll build --destination=/path/to/site
</code></pre>
</div>

<h4 id="jekyll-new-theme-">使用 <code class="highlighter-rouge">jekyll new-theme</code> 创建主题</h4>

<div class="highlighter-rouge"><pre class="highlight"><code>$ jekyll new-theme my-theme
</code></pre>
</div>

<h2 id="section-3">配置</h2>

<h4 id="front-matter-">Front Matter 默认值</h4>

<h2 id="liquid-">Liquid 模板</h2>

<h4 id="liquid">什么是 Liquid?</h4>

<p>Liquid 是一个开源模版语言，由电商公司 Shopify 实现，用 Ruby 编写。Shopify 自己使用 Liquid 来构建自己电商网站模板生态。</p>

<p>详细文档请参考 <a href="https://shopify.github.io/liquid/">https://shopify.github.io/liquid/</a>。</p>

<h4 id="section-4">变量</h4>

<h4 id="if">if</h4>

<h4 id="for--in">for .. in</h4>

<h4 id="assign">assign</h4>

<h4 id="capture">capture</h4>

<h4 id="filters">Filters</h4>

<h2 id="section-5">插件</h2>

<h4 id="jekyll-watch">Jekyll Watch</h4>

<p>Jekyll “必备”的插件，因为这是 Jekyll 程序的依赖，只是因为程序结构设计被剥离成了插件。它在本地预览时，提供文件变更的自动更新，让我们每次刷新都能自动看到最新的内容。</p>

<p>Jekyll Watch 是自动开启的：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ jekyll serve --watch
</code></pre>
</div>

<h4 id="jekyll-compose">Jekyll Compose</h4>

<p>安装了 <a href="https://github.com/jekyll/jekyll-compose">Jekyll Compose</a> 后，Jekyll 会额外提供一些命令，便于发布管理博文。</p>

<p>创建草稿：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ jekyll draft
</code></pre>
</div>

<p>创建新博客：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ jekyll post
</code></pre>
</div>

<p>创建新博客：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ jekyll page
</code></pre>
</div>

<p>发布草稿：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ jekyll publish
</code></pre>
</div>

<p>撤销发布：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ jekyll unpublish
</code></pre>
</div>

<h4 id="jekyll-admin">Jekyll Admin</h4>

<p><a href="https://github.com/jekyll/jekyll-admin">Jekyll Admin</a> 是一个 CMS 风格的图形化后台管理插件，可以在本地给用户提供服务。</p>

<p><img src="https://github.com/jekyll/jekyll-admin/raw/master/screenshot.png" alt="" /></p>

<h4 id="jekyll-seo-tag">Jekyll SEO Tag</h4>

<h4 id="jemoji">Jemoji</h4>

<p>你可以通过 <a href="https://github.com/jekyll/jemoji">Jemoji</a> 在 Jekyll 生成的网站中，加入自己 Emoji 表情。</p>

<p>Emoji 语法采用 GitHub 的语法风格。</p>

<h4 id="jekyll-mentions">Jekyll Mentions</h4>

<h4 id="jekyll-sitemap">Jekyll Sitemap</h4>

<h4 id="jekyll-feed">Jekyll Feed</h4>

<p>你可以通过 <a href="https://github.com/jekyll/jekyll-feed">Jekyll Feed</a> 在 Jekyll 生成的网站中，生成 RSS 源。</p>

<h4 id="jekyll-import">Jekyll Import</h4>

<p><a href="https://github.com/jekyll/jekyll-import">Jekyll Import</a> 支持从一些国外的主流站点导入博文，如 Blogger, WordPress 和 Tumblr 等，同样也支持 RSS 和 CSV 等数据格式导入。</p>

<h4 id="jekyll-archives">Jekyll Archives</h4>

<h4 id="jekyll-redirect-from">Jekyll Redirect From</h4>

<p><a href="https://github.com/jekyll/jekyll-redirect-from">Jekyll Redirect From</a> 提供页面跳转功能，比较简单，也可以自行通过 JavaScript 实现。</p>

<h2 id="github-pages">GitHub Pages</h2>

<h4 id="section-6">创建个人主页</h4>

<p>创建一个名为 <code class="highlighter-rouge">your-github-username.github.io</code> 的 Repo，<code class="highlighter-rouge">your-github-username</code> 是你的用户名。</p>

<p>只需在 Repo 中设置 GitHub Pages 的 Source，就可以开启 GitHub Pages，支持 <code class="highlighter-rouge">master</code>, <code class="highlighter-rouge">gh-pages</code>, <code class="highlighter-rouge">master</code> 中 <code class="highlighter-rouge">/docs</code> 文件夹三种 Source。</p>

<p><img src="/image/github-pages-source.jpg" alt="" /></p>

<h4 id="github-pages-">在 GitHub Pages 只可以使用部分插件</h4>

<p>由于安全性等原因的考虑，在 GitHub Pages 平台上只能使用白名单中的 7 个 Jekyll 插件。它们分别是：Jekyll Sitemap, Jekyll SEO Tag, github-metadata, Jekyll Feed, Jekyll Redirect From, Jemoji 和 Jekyll Mentions。</p>

<p>详见 <a href="https://help.github.com/articles/adding-jekyll-plugins-to-a-github-pages-site/">https://help.github.com/articles/adding-jekyll-plugins-to-a-github-pages-site/</a>。</p>

<h4 id="github-pages--jekyll--kramdown">GitHub Pages 上的 Jekyll 只支持 kramdown</h4>

<p>从 2016 年 5 月 1 日起，GitHub Pages 只支持 kramdown 作为 Markdown 引擎。</p>

<p>详见 <a href="https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0">https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0</a>。</p>

<h4 id="nojekyll--jekyll-">在根目录下创建 <code class="highlighter-rouge">.nojekyll</code> 文件可以跳过 Jekyll 解析</h4>

<p>GitHub Pages 支持 Jekyll 或者原始文件。最初 GitHub Pages 只支持 Jekyll，后来 GitHub 允许在 Repo 根目录下添加 <code class="highlighter-rouge">.nojekyll</code> 跳过解析。详见 <a href="https://github.com/blog/572-bypassing-jekyll-on-github-pages">https://github.com/blog/572-bypassing-jekyll-on-github-pages</a>。</p>

<h4 id="section-7">你可以使用自己的域名</h4>

<p>在 Source 的根路径下，创建 <code class="highlighter-rouge">CNAME</code> 写入域名，然后把 DNS 解析到 GitHub Pages 的 IP：<code class="highlighter-rouge">192.30.252.153</code>和<code class="highlighter-rouge">192.30.252.154</code>。</p>

<p>详见 <a href="https://help.github.com/articles/using-a-custom-domain-with-github-pages/">https://help.github.com/articles/using-a-custom-domain-with-github-pages/</a></p>

<h4 id="section-8">你也可以为账号下任意项目创建独立的项目页面</h4>

<p>任何一个项目的 Repo，都可以开启这个项目的 GitHub Pages。开启方式同个人主页。</p>

<p>如项目：<a href="https://github.com/crispgm/gsm">crispgm/gsm</a>，设置完成后，就可以通过 <a href="https://crispgm.github.io/gsm/">https://crispgm.github.io/gsm/</a> 进行访问。</p>

<h4 id="sitegithub--repo-">你可以通过 <code class="highlighter-rouge">site.github</code> 获得 Repo 的信息</h4>

<p>由上面所说的 <a href="https://github.com/jekyll/github-metadata">github-metadata</a> 提供服务，通过 GitHub API 获取 Repo 的信息。当然，在本地环境下，也可以通过手动安装 github-metadata 来使用。</p>

<h4 id="repo--github-pages">私有 Repo 也可以开启 GitHub Pages</h4>

<p>GitHub 的付费用户建立的私有项目 Private Repo，也可以开启 GitHub Pages。</p>

<h4 id="github-pages--gh-pages-">GitHub Pages 无法在使用 <code class="highlighter-rouge">gh-pages</code> 分支作为源的情况下关闭</h4>

<p>有些奇怪的设定，真想关闭直接删除掉，在 Source 选择 None 就好。</p>

<h2 id="section-9">最后</h2>

<h4 id="jekyll-">本博客也是用 Jekyll 生成的</h4>

<p>Happy Jekylling!</p>

  </div>
  
  <div class="article-tag">
    
    <div class="tag-item">
    jekyll
    </div>
    
    <div class="tag-item">
    tips
    </div>
    
  </div>
  
</div>

    <footer>
      <div>Copyright &copy; David Zhang, 2016.</div>
    </footer>
    
    <script src="/assets/scripts/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-50708664-1', 'auto');
  ga('send', 'pageview');

</script>

    </div>
  </body>
</html>